{"version":3,"file":"index.mjs","sources":["../../../node_modules/react/cjs/react-jsx-runtime.production.min.js","../../../node_modules/react/cjs/react-jsx-runtime.development.js","../../../node_modules/react/jsx-runtime.js","../../../node_modules/@iiif/vault-helpers/dist/esm/index.mjs","../../../node_modules/@iiif/vault-helpers/dist/fetch/esm/fetch.mjs","../../../src/context/IIIFResourceContext.tsx","../../../src/components/Thumbnail.tsx","../../../node_modules/@iiif/vault-helpers/dist/sequences/esm/sequences.mjs","../../../src/components/ThumbnailPanel.tsx"],"sourcesContent":["/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f=require(\"react\"),k=Symbol.for(\"react.element\"),l=Symbol.for(\"react.fragment\"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,g){var b,d={},e=null,h=null;void 0!==g&&(e=\"\"+g);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(h=a.ref);for(b in a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l;exports.jsx=q;exports.jsxs=q;\n","/**\n * @license React\n * react-jsx-runtime.development.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nif (process.env.NODE_ENV !== \"production\") {\n  (function() {\n'use strict';\n\nvar React = require('react');\n\n// ATTENTION\n// When adding new symbols to this file,\n// Please consider also adding to 'react-devtools-shared/src/backend/ReactSymbols'\n// The Symbol used to tag the ReactElement-like types.\nvar REACT_ELEMENT_TYPE = Symbol.for('react.element');\nvar REACT_PORTAL_TYPE = Symbol.for('react.portal');\nvar REACT_FRAGMENT_TYPE = Symbol.for('react.fragment');\nvar REACT_STRICT_MODE_TYPE = Symbol.for('react.strict_mode');\nvar REACT_PROFILER_TYPE = Symbol.for('react.profiler');\nvar REACT_PROVIDER_TYPE = Symbol.for('react.provider');\nvar REACT_CONTEXT_TYPE = Symbol.for('react.context');\nvar REACT_FORWARD_REF_TYPE = Symbol.for('react.forward_ref');\nvar REACT_SUSPENSE_TYPE = Symbol.for('react.suspense');\nvar REACT_SUSPENSE_LIST_TYPE = Symbol.for('react.suspense_list');\nvar REACT_MEMO_TYPE = Symbol.for('react.memo');\nvar REACT_LAZY_TYPE = Symbol.for('react.lazy');\nvar REACT_OFFSCREEN_TYPE = Symbol.for('react.offscreen');\nvar MAYBE_ITERATOR_SYMBOL = Symbol.iterator;\nvar FAUX_ITERATOR_SYMBOL = '@@iterator';\nfunction getIteratorFn(maybeIterable) {\n  if (maybeIterable === null || typeof maybeIterable !== 'object') {\n    return null;\n  }\n\n  var maybeIterator = MAYBE_ITERATOR_SYMBOL && maybeIterable[MAYBE_ITERATOR_SYMBOL] || maybeIterable[FAUX_ITERATOR_SYMBOL];\n\n  if (typeof maybeIterator === 'function') {\n    return maybeIterator;\n  }\n\n  return null;\n}\n\nvar ReactSharedInternals = React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n\nfunction error(format) {\n  {\n    {\n      for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        args[_key2 - 1] = arguments[_key2];\n      }\n\n      printWarning('error', format, args);\n    }\n  }\n}\n\nfunction printWarning(level, format, args) {\n  // When changing this logic, you might want to also\n  // update consoleWithStackDev.www.js as well.\n  {\n    var ReactDebugCurrentFrame = ReactSharedInternals.ReactDebugCurrentFrame;\n    var stack = ReactDebugCurrentFrame.getStackAddendum();\n\n    if (stack !== '') {\n      format += '%s';\n      args = args.concat([stack]);\n    } // eslint-disable-next-line react-internal/safe-string-coercion\n\n\n    var argsWithFormat = args.map(function (item) {\n      return String(item);\n    }); // Careful: RN currently depends on this prefix\n\n    argsWithFormat.unshift('Warning: ' + format); // We intentionally don't use spread (or .apply) directly because it\n    // breaks IE9: https://github.com/facebook/react/issues/13610\n    // eslint-disable-next-line react-internal/no-production-logging\n\n    Function.prototype.apply.call(console[level], console, argsWithFormat);\n  }\n}\n\n// -----------------------------------------------------------------------------\n\nvar enableScopeAPI = false; // Experimental Create Event Handle API.\nvar enableCacheElement = false;\nvar enableTransitionTracing = false; // No known bugs, but needs performance testing\n\nvar enableLegacyHidden = false; // Enables unstable_avoidThisFallback feature in Fiber\n// stuff. Intended to enable React core members to more easily debug scheduling\n// issues in DEV builds.\n\nvar enableDebugTracing = false; // Track which Fiber(s) schedule render work.\n\nvar REACT_MODULE_REFERENCE;\n\n{\n  REACT_MODULE_REFERENCE = Symbol.for('react.module.reference');\n}\n\nfunction isValidElementType(type) {\n  if (typeof type === 'string' || typeof type === 'function') {\n    return true;\n  } // Note: typeof might be other than 'symbol' or 'number' (e.g. if it's a polyfill).\n\n\n  if (type === REACT_FRAGMENT_TYPE || type === REACT_PROFILER_TYPE || enableDebugTracing  || type === REACT_STRICT_MODE_TYPE || type === REACT_SUSPENSE_TYPE || type === REACT_SUSPENSE_LIST_TYPE || enableLegacyHidden  || type === REACT_OFFSCREEN_TYPE || enableScopeAPI  || enableCacheElement  || enableTransitionTracing ) {\n    return true;\n  }\n\n  if (typeof type === 'object' && type !== null) {\n    if (type.$$typeof === REACT_LAZY_TYPE || type.$$typeof === REACT_MEMO_TYPE || type.$$typeof === REACT_PROVIDER_TYPE || type.$$typeof === REACT_CONTEXT_TYPE || type.$$typeof === REACT_FORWARD_REF_TYPE || // This needs to include all possible module reference object\n    // types supported by any Flight configuration anywhere since\n    // we don't know which Flight build this will end up being used\n    // with.\n    type.$$typeof === REACT_MODULE_REFERENCE || type.getModuleId !== undefined) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction getWrappedName(outerType, innerType, wrapperName) {\n  var displayName = outerType.displayName;\n\n  if (displayName) {\n    return displayName;\n  }\n\n  var functionName = innerType.displayName || innerType.name || '';\n  return functionName !== '' ? wrapperName + \"(\" + functionName + \")\" : wrapperName;\n} // Keep in sync with react-reconciler/getComponentNameFromFiber\n\n\nfunction getContextName(type) {\n  return type.displayName || 'Context';\n} // Note that the reconciler package should generally prefer to use getComponentNameFromFiber() instead.\n\n\nfunction getComponentNameFromType(type) {\n  if (type == null) {\n    // Host root, text node or just invalid type.\n    return null;\n  }\n\n  {\n    if (typeof type.tag === 'number') {\n      error('Received an unexpected object in getComponentNameFromType(). ' + 'This is likely a bug in React. Please file an issue.');\n    }\n  }\n\n  if (typeof type === 'function') {\n    return type.displayName || type.name || null;\n  }\n\n  if (typeof type === 'string') {\n    return type;\n  }\n\n  switch (type) {\n    case REACT_FRAGMENT_TYPE:\n      return 'Fragment';\n\n    case REACT_PORTAL_TYPE:\n      return 'Portal';\n\n    case REACT_PROFILER_TYPE:\n      return 'Profiler';\n\n    case REACT_STRICT_MODE_TYPE:\n      return 'StrictMode';\n\n    case REACT_SUSPENSE_TYPE:\n      return 'Suspense';\n\n    case REACT_SUSPENSE_LIST_TYPE:\n      return 'SuspenseList';\n\n  }\n\n  if (typeof type === 'object') {\n    switch (type.$$typeof) {\n      case REACT_CONTEXT_TYPE:\n        var context = type;\n        return getContextName(context) + '.Consumer';\n\n      case REACT_PROVIDER_TYPE:\n        var provider = type;\n        return getContextName(provider._context) + '.Provider';\n\n      case REACT_FORWARD_REF_TYPE:\n        return getWrappedName(type, type.render, 'ForwardRef');\n\n      case REACT_MEMO_TYPE:\n        var outerName = type.displayName || null;\n\n        if (outerName !== null) {\n          return outerName;\n        }\n\n        return getComponentNameFromType(type.type) || 'Memo';\n\n      case REACT_LAZY_TYPE:\n        {\n          var lazyComponent = type;\n          var payload = lazyComponent._payload;\n          var init = lazyComponent._init;\n\n          try {\n            return getComponentNameFromType(init(payload));\n          } catch (x) {\n            return null;\n          }\n        }\n\n      // eslint-disable-next-line no-fallthrough\n    }\n  }\n\n  return null;\n}\n\nvar assign = Object.assign;\n\n// Helpers to patch console.logs to avoid logging during side-effect free\n// replaying on render function. This currently only patches the object\n// lazily which won't cover if the log function was extracted eagerly.\n// We could also eagerly patch the method.\nvar disabledDepth = 0;\nvar prevLog;\nvar prevInfo;\nvar prevWarn;\nvar prevError;\nvar prevGroup;\nvar prevGroupCollapsed;\nvar prevGroupEnd;\n\nfunction disabledLog() {}\n\ndisabledLog.__reactDisabledLog = true;\nfunction disableLogs() {\n  {\n    if (disabledDepth === 0) {\n      /* eslint-disable react-internal/no-production-logging */\n      prevLog = console.log;\n      prevInfo = console.info;\n      prevWarn = console.warn;\n      prevError = console.error;\n      prevGroup = console.group;\n      prevGroupCollapsed = console.groupCollapsed;\n      prevGroupEnd = console.groupEnd; // https://github.com/facebook/react/issues/19099\n\n      var props = {\n        configurable: true,\n        enumerable: true,\n        value: disabledLog,\n        writable: true\n      }; // $FlowFixMe Flow thinks console is immutable.\n\n      Object.defineProperties(console, {\n        info: props,\n        log: props,\n        warn: props,\n        error: props,\n        group: props,\n        groupCollapsed: props,\n        groupEnd: props\n      });\n      /* eslint-enable react-internal/no-production-logging */\n    }\n\n    disabledDepth++;\n  }\n}\nfunction reenableLogs() {\n  {\n    disabledDepth--;\n\n    if (disabledDepth === 0) {\n      /* eslint-disable react-internal/no-production-logging */\n      var props = {\n        configurable: true,\n        enumerable: true,\n        writable: true\n      }; // $FlowFixMe Flow thinks console is immutable.\n\n      Object.defineProperties(console, {\n        log: assign({}, props, {\n          value: prevLog\n        }),\n        info: assign({}, props, {\n          value: prevInfo\n        }),\n        warn: assign({}, props, {\n          value: prevWarn\n        }),\n        error: assign({}, props, {\n          value: prevError\n        }),\n        group: assign({}, props, {\n          value: prevGroup\n        }),\n        groupCollapsed: assign({}, props, {\n          value: prevGroupCollapsed\n        }),\n        groupEnd: assign({}, props, {\n          value: prevGroupEnd\n        })\n      });\n      /* eslint-enable react-internal/no-production-logging */\n    }\n\n    if (disabledDepth < 0) {\n      error('disabledDepth fell below zero. ' + 'This is a bug in React. Please file an issue.');\n    }\n  }\n}\n\nvar ReactCurrentDispatcher = ReactSharedInternals.ReactCurrentDispatcher;\nvar prefix;\nfunction describeBuiltInComponentFrame(name, source, ownerFn) {\n  {\n    if (prefix === undefined) {\n      // Extract the VM specific prefix used by each line.\n      try {\n        throw Error();\n      } catch (x) {\n        var match = x.stack.trim().match(/\\n( *(at )?)/);\n        prefix = match && match[1] || '';\n      }\n    } // We use the prefix to ensure our stacks line up with native stack frames.\n\n\n    return '\\n' + prefix + name;\n  }\n}\nvar reentry = false;\nvar componentFrameCache;\n\n{\n  var PossiblyWeakMap = typeof WeakMap === 'function' ? WeakMap : Map;\n  componentFrameCache = new PossiblyWeakMap();\n}\n\nfunction describeNativeComponentFrame(fn, construct) {\n  // If something asked for a stack inside a fake render, it should get ignored.\n  if ( !fn || reentry) {\n    return '';\n  }\n\n  {\n    var frame = componentFrameCache.get(fn);\n\n    if (frame !== undefined) {\n      return frame;\n    }\n  }\n\n  var control;\n  reentry = true;\n  var previousPrepareStackTrace = Error.prepareStackTrace; // $FlowFixMe It does accept undefined.\n\n  Error.prepareStackTrace = undefined;\n  var previousDispatcher;\n\n  {\n    previousDispatcher = ReactCurrentDispatcher.current; // Set the dispatcher in DEV because this might be call in the render function\n    // for warnings.\n\n    ReactCurrentDispatcher.current = null;\n    disableLogs();\n  }\n\n  try {\n    // This should throw.\n    if (construct) {\n      // Something should be setting the props in the constructor.\n      var Fake = function () {\n        throw Error();\n      }; // $FlowFixMe\n\n\n      Object.defineProperty(Fake.prototype, 'props', {\n        set: function () {\n          // We use a throwing setter instead of frozen or non-writable props\n          // because that won't throw in a non-strict mode function.\n          throw Error();\n        }\n      });\n\n      if (typeof Reflect === 'object' && Reflect.construct) {\n        // We construct a different control for this case to include any extra\n        // frames added by the construct call.\n        try {\n          Reflect.construct(Fake, []);\n        } catch (x) {\n          control = x;\n        }\n\n        Reflect.construct(fn, [], Fake);\n      } else {\n        try {\n          Fake.call();\n        } catch (x) {\n          control = x;\n        }\n\n        fn.call(Fake.prototype);\n      }\n    } else {\n      try {\n        throw Error();\n      } catch (x) {\n        control = x;\n      }\n\n      fn();\n    }\n  } catch (sample) {\n    // This is inlined manually because closure doesn't do it for us.\n    if (sample && control && typeof sample.stack === 'string') {\n      // This extracts the first frame from the sample that isn't also in the control.\n      // Skipping one frame that we assume is the frame that calls the two.\n      var sampleLines = sample.stack.split('\\n');\n      var controlLines = control.stack.split('\\n');\n      var s = sampleLines.length - 1;\n      var c = controlLines.length - 1;\n\n      while (s >= 1 && c >= 0 && sampleLines[s] !== controlLines[c]) {\n        // We expect at least one stack frame to be shared.\n        // Typically this will be the root most one. However, stack frames may be\n        // cut off due to maximum stack limits. In this case, one maybe cut off\n        // earlier than the other. We assume that the sample is longer or the same\n        // and there for cut off earlier. So we should find the root most frame in\n        // the sample somewhere in the control.\n        c--;\n      }\n\n      for (; s >= 1 && c >= 0; s--, c--) {\n        // Next we find the first one that isn't the same which should be the\n        // frame that called our sample function and the control.\n        if (sampleLines[s] !== controlLines[c]) {\n          // In V8, the first line is describing the message but other VMs don't.\n          // If we're about to return the first line, and the control is also on the same\n          // line, that's a pretty good indicator that our sample threw at same line as\n          // the control. I.e. before we entered the sample frame. So we ignore this result.\n          // This can happen if you passed a class to function component, or non-function.\n          if (s !== 1 || c !== 1) {\n            do {\n              s--;\n              c--; // We may still have similar intermediate frames from the construct call.\n              // The next one that isn't the same should be our match though.\n\n              if (c < 0 || sampleLines[s] !== controlLines[c]) {\n                // V8 adds a \"new\" prefix for native classes. Let's remove it to make it prettier.\n                var _frame = '\\n' + sampleLines[s].replace(' at new ', ' at '); // If our component frame is labeled \"<anonymous>\"\n                // but we have a user-provided \"displayName\"\n                // splice it in to make the stack more readable.\n\n\n                if (fn.displayName && _frame.includes('<anonymous>')) {\n                  _frame = _frame.replace('<anonymous>', fn.displayName);\n                }\n\n                {\n                  if (typeof fn === 'function') {\n                    componentFrameCache.set(fn, _frame);\n                  }\n                } // Return the line we found.\n\n\n                return _frame;\n              }\n            } while (s >= 1 && c >= 0);\n          }\n\n          break;\n        }\n      }\n    }\n  } finally {\n    reentry = false;\n\n    {\n      ReactCurrentDispatcher.current = previousDispatcher;\n      reenableLogs();\n    }\n\n    Error.prepareStackTrace = previousPrepareStackTrace;\n  } // Fallback to just using the name if we couldn't make it throw.\n\n\n  var name = fn ? fn.displayName || fn.name : '';\n  var syntheticFrame = name ? describeBuiltInComponentFrame(name) : '';\n\n  {\n    if (typeof fn === 'function') {\n      componentFrameCache.set(fn, syntheticFrame);\n    }\n  }\n\n  return syntheticFrame;\n}\nfunction describeFunctionComponentFrame(fn, source, ownerFn) {\n  {\n    return describeNativeComponentFrame(fn, false);\n  }\n}\n\nfunction shouldConstruct(Component) {\n  var prototype = Component.prototype;\n  return !!(prototype && prototype.isReactComponent);\n}\n\nfunction describeUnknownElementTypeFrameInDEV(type, source, ownerFn) {\n\n  if (type == null) {\n    return '';\n  }\n\n  if (typeof type === 'function') {\n    {\n      return describeNativeComponentFrame(type, shouldConstruct(type));\n    }\n  }\n\n  if (typeof type === 'string') {\n    return describeBuiltInComponentFrame(type);\n  }\n\n  switch (type) {\n    case REACT_SUSPENSE_TYPE:\n      return describeBuiltInComponentFrame('Suspense');\n\n    case REACT_SUSPENSE_LIST_TYPE:\n      return describeBuiltInComponentFrame('SuspenseList');\n  }\n\n  if (typeof type === 'object') {\n    switch (type.$$typeof) {\n      case REACT_FORWARD_REF_TYPE:\n        return describeFunctionComponentFrame(type.render);\n\n      case REACT_MEMO_TYPE:\n        // Memo may contain any component type so we recursively resolve it.\n        return describeUnknownElementTypeFrameInDEV(type.type, source, ownerFn);\n\n      case REACT_LAZY_TYPE:\n        {\n          var lazyComponent = type;\n          var payload = lazyComponent._payload;\n          var init = lazyComponent._init;\n\n          try {\n            // Lazy may contain any component type so we recursively resolve it.\n            return describeUnknownElementTypeFrameInDEV(init(payload), source, ownerFn);\n          } catch (x) {}\n        }\n    }\n  }\n\n  return '';\n}\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nvar loggedTypeFailures = {};\nvar ReactDebugCurrentFrame = ReactSharedInternals.ReactDebugCurrentFrame;\n\nfunction setCurrentlyValidatingElement(element) {\n  {\n    if (element) {\n      var owner = element._owner;\n      var stack = describeUnknownElementTypeFrameInDEV(element.type, element._source, owner ? owner.type : null);\n      ReactDebugCurrentFrame.setExtraStackFrame(stack);\n    } else {\n      ReactDebugCurrentFrame.setExtraStackFrame(null);\n    }\n  }\n}\n\nfunction checkPropTypes(typeSpecs, values, location, componentName, element) {\n  {\n    // $FlowFixMe This is okay but Flow doesn't know it.\n    var has = Function.call.bind(hasOwnProperty);\n\n    for (var typeSpecName in typeSpecs) {\n      if (has(typeSpecs, typeSpecName)) {\n        var error$1 = void 0; // Prop type validation may throw. In case they do, we don't want to\n        // fail the render phase where it didn't fail before. So we log it.\n        // After these have been cleaned up, we'll let them throw.\n\n        try {\n          // This is intentionally an invariant that gets caught. It's the same\n          // behavior as without this statement except with a better message.\n          if (typeof typeSpecs[typeSpecName] !== 'function') {\n            // eslint-disable-next-line react-internal/prod-error-codes\n            var err = Error((componentName || 'React class') + ': ' + location + ' type `' + typeSpecName + '` is invalid; ' + 'it must be a function, usually from the `prop-types` package, but received `' + typeof typeSpecs[typeSpecName] + '`.' + 'This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.');\n            err.name = 'Invariant Violation';\n            throw err;\n          }\n\n          error$1 = typeSpecs[typeSpecName](values, typeSpecName, componentName, location, null, 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED');\n        } catch (ex) {\n          error$1 = ex;\n        }\n\n        if (error$1 && !(error$1 instanceof Error)) {\n          setCurrentlyValidatingElement(element);\n\n          error('%s: type specification of %s' + ' `%s` is invalid; the type checker ' + 'function must return `null` or an `Error` but returned a %s. ' + 'You may have forgotten to pass an argument to the type checker ' + 'creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and ' + 'shape all require an argument).', componentName || 'React class', location, typeSpecName, typeof error$1);\n\n          setCurrentlyValidatingElement(null);\n        }\n\n        if (error$1 instanceof Error && !(error$1.message in loggedTypeFailures)) {\n          // Only monitor this failure once because there tends to be a lot of the\n          // same error.\n          loggedTypeFailures[error$1.message] = true;\n          setCurrentlyValidatingElement(element);\n\n          error('Failed %s type: %s', location, error$1.message);\n\n          setCurrentlyValidatingElement(null);\n        }\n      }\n    }\n  }\n}\n\nvar isArrayImpl = Array.isArray; // eslint-disable-next-line no-redeclare\n\nfunction isArray(a) {\n  return isArrayImpl(a);\n}\n\n/*\n * The `'' + value` pattern (used in in perf-sensitive code) throws for Symbol\n * and Temporal.* types. See https://github.com/facebook/react/pull/22064.\n *\n * The functions in this module will throw an easier-to-understand,\n * easier-to-debug exception with a clear errors message message explaining the\n * problem. (Instead of a confusing exception thrown inside the implementation\n * of the `value` object).\n */\n// $FlowFixMe only called in DEV, so void return is not possible.\nfunction typeName(value) {\n  {\n    // toStringTag is needed for namespaced types like Temporal.Instant\n    var hasToStringTag = typeof Symbol === 'function' && Symbol.toStringTag;\n    var type = hasToStringTag && value[Symbol.toStringTag] || value.constructor.name || 'Object';\n    return type;\n  }\n} // $FlowFixMe only called in DEV, so void return is not possible.\n\n\nfunction willCoercionThrow(value) {\n  {\n    try {\n      testStringCoercion(value);\n      return false;\n    } catch (e) {\n      return true;\n    }\n  }\n}\n\nfunction testStringCoercion(value) {\n  // If you ended up here by following an exception call stack, here's what's\n  // happened: you supplied an object or symbol value to React (as a prop, key,\n  // DOM attribute, CSS property, string ref, etc.) and when React tried to\n  // coerce it to a string using `'' + value`, an exception was thrown.\n  //\n  // The most common types that will cause this exception are `Symbol` instances\n  // and Temporal objects like `Temporal.Instant`. But any object that has a\n  // `valueOf` or `[Symbol.toPrimitive]` method that throws will also cause this\n  // exception. (Library authors do this to prevent users from using built-in\n  // numeric operators like `+` or comparison operators like `>=` because custom\n  // methods are needed to perform accurate arithmetic or comparison.)\n  //\n  // To fix the problem, coerce this object or symbol value to a string before\n  // passing it to React. The most reliable way is usually `String(value)`.\n  //\n  // To find which value is throwing, check the browser or debugger console.\n  // Before this exception was thrown, there should be `console.error` output\n  // that shows the type (Symbol, Temporal.PlainDate, etc.) that caused the\n  // problem and how that type was used: key, atrribute, input value prop, etc.\n  // In most cases, this console output also shows the component and its\n  // ancestor components where the exception happened.\n  //\n  // eslint-disable-next-line react-internal/safe-string-coercion\n  return '' + value;\n}\nfunction checkKeyStringCoercion(value) {\n  {\n    if (willCoercionThrow(value)) {\n      error('The provided key is an unsupported type %s.' + ' This value must be coerced to a string before before using it here.', typeName(value));\n\n      return testStringCoercion(value); // throw (to help callers find troubleshooting comments)\n    }\n  }\n}\n\nvar ReactCurrentOwner = ReactSharedInternals.ReactCurrentOwner;\nvar RESERVED_PROPS = {\n  key: true,\n  ref: true,\n  __self: true,\n  __source: true\n};\nvar specialPropKeyWarningShown;\nvar specialPropRefWarningShown;\nvar didWarnAboutStringRefs;\n\n{\n  didWarnAboutStringRefs = {};\n}\n\nfunction hasValidRef(config) {\n  {\n    if (hasOwnProperty.call(config, 'ref')) {\n      var getter = Object.getOwnPropertyDescriptor(config, 'ref').get;\n\n      if (getter && getter.isReactWarning) {\n        return false;\n      }\n    }\n  }\n\n  return config.ref !== undefined;\n}\n\nfunction hasValidKey(config) {\n  {\n    if (hasOwnProperty.call(config, 'key')) {\n      var getter = Object.getOwnPropertyDescriptor(config, 'key').get;\n\n      if (getter && getter.isReactWarning) {\n        return false;\n      }\n    }\n  }\n\n  return config.key !== undefined;\n}\n\nfunction warnIfStringRefCannotBeAutoConverted(config, self) {\n  {\n    if (typeof config.ref === 'string' && ReactCurrentOwner.current && self && ReactCurrentOwner.current.stateNode !== self) {\n      var componentName = getComponentNameFromType(ReactCurrentOwner.current.type);\n\n      if (!didWarnAboutStringRefs[componentName]) {\n        error('Component \"%s\" contains the string ref \"%s\". ' + 'Support for string refs will be removed in a future major release. ' + 'This case cannot be automatically converted to an arrow function. ' + 'We ask you to manually fix this case by using useRef() or createRef() instead. ' + 'Learn more about using refs safely here: ' + 'https://reactjs.org/link/strict-mode-string-ref', getComponentNameFromType(ReactCurrentOwner.current.type), config.ref);\n\n        didWarnAboutStringRefs[componentName] = true;\n      }\n    }\n  }\n}\n\nfunction defineKeyPropWarningGetter(props, displayName) {\n  {\n    var warnAboutAccessingKey = function () {\n      if (!specialPropKeyWarningShown) {\n        specialPropKeyWarningShown = true;\n\n        error('%s: `key` is not a prop. Trying to access it will result ' + 'in `undefined` being returned. If you need to access the same ' + 'value within the child component, you should pass it as a different ' + 'prop. (https://reactjs.org/link/special-props)', displayName);\n      }\n    };\n\n    warnAboutAccessingKey.isReactWarning = true;\n    Object.defineProperty(props, 'key', {\n      get: warnAboutAccessingKey,\n      configurable: true\n    });\n  }\n}\n\nfunction defineRefPropWarningGetter(props, displayName) {\n  {\n    var warnAboutAccessingRef = function () {\n      if (!specialPropRefWarningShown) {\n        specialPropRefWarningShown = true;\n\n        error('%s: `ref` is not a prop. Trying to access it will result ' + 'in `undefined` being returned. If you need to access the same ' + 'value within the child component, you should pass it as a different ' + 'prop. (https://reactjs.org/link/special-props)', displayName);\n      }\n    };\n\n    warnAboutAccessingRef.isReactWarning = true;\n    Object.defineProperty(props, 'ref', {\n      get: warnAboutAccessingRef,\n      configurable: true\n    });\n  }\n}\n/**\n * Factory method to create a new React element. This no longer adheres to\n * the class pattern, so do not use new to call it. Also, instanceof check\n * will not work. Instead test $$typeof field against Symbol.for('react.element') to check\n * if something is a React Element.\n *\n * @param {*} type\n * @param {*} props\n * @param {*} key\n * @param {string|object} ref\n * @param {*} owner\n * @param {*} self A *temporary* helper to detect places where `this` is\n * different from the `owner` when React.createElement is called, so that we\n * can warn. We want to get rid of owner and replace string `ref`s with arrow\n * functions, and as long as `this` and owner are the same, there will be no\n * change in behavior.\n * @param {*} source An annotation object (added by a transpiler or otherwise)\n * indicating filename, line number, and/or other information.\n * @internal\n */\n\n\nvar ReactElement = function (type, key, ref, self, source, owner, props) {\n  var element = {\n    // This tag allows us to uniquely identify this as a React Element\n    $$typeof: REACT_ELEMENT_TYPE,\n    // Built-in properties that belong on the element\n    type: type,\n    key: key,\n    ref: ref,\n    props: props,\n    // Record the component responsible for creating this element.\n    _owner: owner\n  };\n\n  {\n    // The validation flag is currently mutative. We put it on\n    // an external backing store so that we can freeze the whole object.\n    // This can be replaced with a WeakMap once they are implemented in\n    // commonly used development environments.\n    element._store = {}; // To make comparing ReactElements easier for testing purposes, we make\n    // the validation flag non-enumerable (where possible, which should\n    // include every environment we run tests in), so the test framework\n    // ignores it.\n\n    Object.defineProperty(element._store, 'validated', {\n      configurable: false,\n      enumerable: false,\n      writable: true,\n      value: false\n    }); // self and source are DEV only properties.\n\n    Object.defineProperty(element, '_self', {\n      configurable: false,\n      enumerable: false,\n      writable: false,\n      value: self\n    }); // Two elements created in two different places should be considered\n    // equal for testing purposes and therefore we hide it from enumeration.\n\n    Object.defineProperty(element, '_source', {\n      configurable: false,\n      enumerable: false,\n      writable: false,\n      value: source\n    });\n\n    if (Object.freeze) {\n      Object.freeze(element.props);\n      Object.freeze(element);\n    }\n  }\n\n  return element;\n};\n/**\n * https://github.com/reactjs/rfcs/pull/107\n * @param {*} type\n * @param {object} props\n * @param {string} key\n */\n\nfunction jsxDEV(type, config, maybeKey, source, self) {\n  {\n    var propName; // Reserved names are extracted\n\n    var props = {};\n    var key = null;\n    var ref = null; // Currently, key can be spread in as a prop. This causes a potential\n    // issue if key is also explicitly declared (ie. <div {...props} key=\"Hi\" />\n    // or <div key=\"Hi\" {...props} /> ). We want to deprecate key spread,\n    // but as an intermediary step, we will use jsxDEV for everything except\n    // <div {...props} key=\"Hi\" />, because we aren't currently able to tell if\n    // key is explicitly declared to be undefined or not.\n\n    if (maybeKey !== undefined) {\n      {\n        checkKeyStringCoercion(maybeKey);\n      }\n\n      key = '' + maybeKey;\n    }\n\n    if (hasValidKey(config)) {\n      {\n        checkKeyStringCoercion(config.key);\n      }\n\n      key = '' + config.key;\n    }\n\n    if (hasValidRef(config)) {\n      ref = config.ref;\n      warnIfStringRefCannotBeAutoConverted(config, self);\n    } // Remaining properties are added to a new props object\n\n\n    for (propName in config) {\n      if (hasOwnProperty.call(config, propName) && !RESERVED_PROPS.hasOwnProperty(propName)) {\n        props[propName] = config[propName];\n      }\n    } // Resolve default props\n\n\n    if (type && type.defaultProps) {\n      var defaultProps = type.defaultProps;\n\n      for (propName in defaultProps) {\n        if (props[propName] === undefined) {\n          props[propName] = defaultProps[propName];\n        }\n      }\n    }\n\n    if (key || ref) {\n      var displayName = typeof type === 'function' ? type.displayName || type.name || 'Unknown' : type;\n\n      if (key) {\n        defineKeyPropWarningGetter(props, displayName);\n      }\n\n      if (ref) {\n        defineRefPropWarningGetter(props, displayName);\n      }\n    }\n\n    return ReactElement(type, key, ref, self, source, ReactCurrentOwner.current, props);\n  }\n}\n\nvar ReactCurrentOwner$1 = ReactSharedInternals.ReactCurrentOwner;\nvar ReactDebugCurrentFrame$1 = ReactSharedInternals.ReactDebugCurrentFrame;\n\nfunction setCurrentlyValidatingElement$1(element) {\n  {\n    if (element) {\n      var owner = element._owner;\n      var stack = describeUnknownElementTypeFrameInDEV(element.type, element._source, owner ? owner.type : null);\n      ReactDebugCurrentFrame$1.setExtraStackFrame(stack);\n    } else {\n      ReactDebugCurrentFrame$1.setExtraStackFrame(null);\n    }\n  }\n}\n\nvar propTypesMisspellWarningShown;\n\n{\n  propTypesMisspellWarningShown = false;\n}\n/**\n * Verifies the object is a ReactElement.\n * See https://reactjs.org/docs/react-api.html#isvalidelement\n * @param {?object} object\n * @return {boolean} True if `object` is a ReactElement.\n * @final\n */\n\n\nfunction isValidElement(object) {\n  {\n    return typeof object === 'object' && object !== null && object.$$typeof === REACT_ELEMENT_TYPE;\n  }\n}\n\nfunction getDeclarationErrorAddendum() {\n  {\n    if (ReactCurrentOwner$1.current) {\n      var name = getComponentNameFromType(ReactCurrentOwner$1.current.type);\n\n      if (name) {\n        return '\\n\\nCheck the render method of `' + name + '`.';\n      }\n    }\n\n    return '';\n  }\n}\n\nfunction getSourceInfoErrorAddendum(source) {\n  {\n    if (source !== undefined) {\n      var fileName = source.fileName.replace(/^.*[\\\\\\/]/, '');\n      var lineNumber = source.lineNumber;\n      return '\\n\\nCheck your code at ' + fileName + ':' + lineNumber + '.';\n    }\n\n    return '';\n  }\n}\n/**\n * Warn if there's no key explicitly set on dynamic arrays of children or\n * object keys are not valid. This allows us to keep track of children between\n * updates.\n */\n\n\nvar ownerHasKeyUseWarning = {};\n\nfunction getCurrentComponentErrorInfo(parentType) {\n  {\n    var info = getDeclarationErrorAddendum();\n\n    if (!info) {\n      var parentName = typeof parentType === 'string' ? parentType : parentType.displayName || parentType.name;\n\n      if (parentName) {\n        info = \"\\n\\nCheck the top-level render call using <\" + parentName + \">.\";\n      }\n    }\n\n    return info;\n  }\n}\n/**\n * Warn if the element doesn't have an explicit key assigned to it.\n * This element is in an array. The array could grow and shrink or be\n * reordered. All children that haven't already been validated are required to\n * have a \"key\" property assigned to it. Error statuses are cached so a warning\n * will only be shown once.\n *\n * @internal\n * @param {ReactElement} element Element that requires a key.\n * @param {*} parentType element's parent's type.\n */\n\n\nfunction validateExplicitKey(element, parentType) {\n  {\n    if (!element._store || element._store.validated || element.key != null) {\n      return;\n    }\n\n    element._store.validated = true;\n    var currentComponentErrorInfo = getCurrentComponentErrorInfo(parentType);\n\n    if (ownerHasKeyUseWarning[currentComponentErrorInfo]) {\n      return;\n    }\n\n    ownerHasKeyUseWarning[currentComponentErrorInfo] = true; // Usually the current owner is the offender, but if it accepts children as a\n    // property, it may be the creator of the child that's responsible for\n    // assigning it a key.\n\n    var childOwner = '';\n\n    if (element && element._owner && element._owner !== ReactCurrentOwner$1.current) {\n      // Give the component that originally created this child.\n      childOwner = \" It was passed a child from \" + getComponentNameFromType(element._owner.type) + \".\";\n    }\n\n    setCurrentlyValidatingElement$1(element);\n\n    error('Each child in a list should have a unique \"key\" prop.' + '%s%s See https://reactjs.org/link/warning-keys for more information.', currentComponentErrorInfo, childOwner);\n\n    setCurrentlyValidatingElement$1(null);\n  }\n}\n/**\n * Ensure that every element either is passed in a static location, in an\n * array with an explicit keys property defined, or in an object literal\n * with valid key property.\n *\n * @internal\n * @param {ReactNode} node Statically passed child of any type.\n * @param {*} parentType node's parent's type.\n */\n\n\nfunction validateChildKeys(node, parentType) {\n  {\n    if (typeof node !== 'object') {\n      return;\n    }\n\n    if (isArray(node)) {\n      for (var i = 0; i < node.length; i++) {\n        var child = node[i];\n\n        if (isValidElement(child)) {\n          validateExplicitKey(child, parentType);\n        }\n      }\n    } else if (isValidElement(node)) {\n      // This element was passed in a valid location.\n      if (node._store) {\n        node._store.validated = true;\n      }\n    } else if (node) {\n      var iteratorFn = getIteratorFn(node);\n\n      if (typeof iteratorFn === 'function') {\n        // Entry iterators used to provide implicit keys,\n        // but now we print a separate warning for them later.\n        if (iteratorFn !== node.entries) {\n          var iterator = iteratorFn.call(node);\n          var step;\n\n          while (!(step = iterator.next()).done) {\n            if (isValidElement(step.value)) {\n              validateExplicitKey(step.value, parentType);\n            }\n          }\n        }\n      }\n    }\n  }\n}\n/**\n * Given an element, validate that its props follow the propTypes definition,\n * provided by the type.\n *\n * @param {ReactElement} element\n */\n\n\nfunction validatePropTypes(element) {\n  {\n    var type = element.type;\n\n    if (type === null || type === undefined || typeof type === 'string') {\n      return;\n    }\n\n    var propTypes;\n\n    if (typeof type === 'function') {\n      propTypes = type.propTypes;\n    } else if (typeof type === 'object' && (type.$$typeof === REACT_FORWARD_REF_TYPE || // Note: Memo only checks outer props here.\n    // Inner props are checked in the reconciler.\n    type.$$typeof === REACT_MEMO_TYPE)) {\n      propTypes = type.propTypes;\n    } else {\n      return;\n    }\n\n    if (propTypes) {\n      // Intentionally inside to avoid triggering lazy initializers:\n      var name = getComponentNameFromType(type);\n      checkPropTypes(propTypes, element.props, 'prop', name, element);\n    } else if (type.PropTypes !== undefined && !propTypesMisspellWarningShown) {\n      propTypesMisspellWarningShown = true; // Intentionally inside to avoid triggering lazy initializers:\n\n      var _name = getComponentNameFromType(type);\n\n      error('Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?', _name || 'Unknown');\n    }\n\n    if (typeof type.getDefaultProps === 'function' && !type.getDefaultProps.isReactClassApproved) {\n      error('getDefaultProps is only used on classic React.createClass ' + 'definitions. Use a static property named `defaultProps` instead.');\n    }\n  }\n}\n/**\n * Given a fragment, validate that it can only be provided with fragment props\n * @param {ReactElement} fragment\n */\n\n\nfunction validateFragmentProps(fragment) {\n  {\n    var keys = Object.keys(fragment.props);\n\n    for (var i = 0; i < keys.length; i++) {\n      var key = keys[i];\n\n      if (key !== 'children' && key !== 'key') {\n        setCurrentlyValidatingElement$1(fragment);\n\n        error('Invalid prop `%s` supplied to `React.Fragment`. ' + 'React.Fragment can only have `key` and `children` props.', key);\n\n        setCurrentlyValidatingElement$1(null);\n        break;\n      }\n    }\n\n    if (fragment.ref !== null) {\n      setCurrentlyValidatingElement$1(fragment);\n\n      error('Invalid attribute `ref` supplied to `React.Fragment`.');\n\n      setCurrentlyValidatingElement$1(null);\n    }\n  }\n}\n\nfunction jsxWithValidation(type, props, key, isStaticChildren, source, self) {\n  {\n    var validType = isValidElementType(type); // We warn in this case but don't throw. We expect the element creation to\n    // succeed and there will likely be errors in render.\n\n    if (!validType) {\n      var info = '';\n\n      if (type === undefined || typeof type === 'object' && type !== null && Object.keys(type).length === 0) {\n        info += ' You likely forgot to export your component from the file ' + \"it's defined in, or you might have mixed up default and named imports.\";\n      }\n\n      var sourceInfo = getSourceInfoErrorAddendum(source);\n\n      if (sourceInfo) {\n        info += sourceInfo;\n      } else {\n        info += getDeclarationErrorAddendum();\n      }\n\n      var typeString;\n\n      if (type === null) {\n        typeString = 'null';\n      } else if (isArray(type)) {\n        typeString = 'array';\n      } else if (type !== undefined && type.$$typeof === REACT_ELEMENT_TYPE) {\n        typeString = \"<\" + (getComponentNameFromType(type.type) || 'Unknown') + \" />\";\n        info = ' Did you accidentally export a JSX literal instead of a component?';\n      } else {\n        typeString = typeof type;\n      }\n\n      error('React.jsx: type is invalid -- expected a string (for ' + 'built-in components) or a class/function (for composite ' + 'components) but got: %s.%s', typeString, info);\n    }\n\n    var element = jsxDEV(type, props, key, source, self); // The result can be nullish if a mock or a custom function is used.\n    // TODO: Drop this when these are no longer allowed as the type argument.\n\n    if (element == null) {\n      return element;\n    } // Skip key warning if the type isn't valid since our key validation logic\n    // doesn't expect a non-string/function type and can throw confusing errors.\n    // We don't want exception behavior to differ between dev and prod.\n    // (Rendering will throw with a helpful message and as soon as the type is\n    // fixed, the key warnings will appear.)\n\n\n    if (validType) {\n      var children = props.children;\n\n      if (children !== undefined) {\n        if (isStaticChildren) {\n          if (isArray(children)) {\n            for (var i = 0; i < children.length; i++) {\n              validateChildKeys(children[i], type);\n            }\n\n            if (Object.freeze) {\n              Object.freeze(children);\n            }\n          } else {\n            error('React.jsx: Static children should always be an array. ' + 'You are likely explicitly calling React.jsxs or React.jsxDEV. ' + 'Use the Babel transform instead.');\n          }\n        } else {\n          validateChildKeys(children, type);\n        }\n      }\n    }\n\n    if (type === REACT_FRAGMENT_TYPE) {\n      validateFragmentProps(element);\n    } else {\n      validatePropTypes(element);\n    }\n\n    return element;\n  }\n} // These two functions exist to still get child warnings in dev\n// even with the prod transform. This means that jsxDEV is purely\n// opt-in behavior for better messages but that we won't stop\n// giving you warnings if you use production apis.\n\nfunction jsxWithValidationStatic(type, props, key) {\n  {\n    return jsxWithValidation(type, props, key, true);\n  }\n}\nfunction jsxWithValidationDynamic(type, props, key) {\n  {\n    return jsxWithValidation(type, props, key, false);\n  }\n}\n\nvar jsx =  jsxWithValidationDynamic ; // we may want to special case jsxs internally to take advantage of static children.\n// for now we can ship identical prod functions\n\nvar jsxs =  jsxWithValidationStatic ;\n\nexports.Fragment = REACT_FRAGMENT_TYPE;\nexports.jsx = jsx;\nexports.jsxs = jsxs;\n  })();\n}\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","const metaState = {};\nconst compatVault = {\n  get(nonRef) {\n    return nonRef;\n  },\n  setMetaValue([id, meta, key], value) {\n    const oldValue = compatVault.getResourceMeta(id, meta);\n    const oldValueItem = oldValue ? oldValue[key] : void 0;\n    const newValue = typeof value === \"function\" ? value(oldValueItem) : value;\n    metaState[id] = {\n      ...metaState[id] || {},\n      [meta]: {\n        ...(metaState[id] || {})[meta] || {},\n        [key]: newValue\n      }\n    };\n  },\n  getResourceMeta: (resource, metaKey) => {\n    const resourceMeta = metaState[resource];\n    if (!resourceMeta) {\n      return void 0;\n    }\n    if (!metaKey) {\n      return resourceMeta;\n    }\n    return resourceMeta[metaKey];\n  }\n};\nfunction createEventsHelper(vault = compatVault) {\n  return {\n    addEventListener(resource, event, listener, scope) {\n      if (!resource) {\n        return;\n      }\n      vault.setMetaValue(\n        [resource.id, \"eventManager\", event],\n        (registeredCallbacks) => {\n          const callbacks = registeredCallbacks || [];\n          for (const registered of callbacks) {\n            if (registered.callback === listener) {\n              return callbacks;\n            }\n          }\n          return [...callbacks, { callback: listener, scope }];\n        }\n      );\n      return listener;\n    },\n    removeEventListener(resource, event, listener) {\n      if (!resource) {\n        return;\n      }\n      vault.setMetaValue(\n        [resource.id, \"eventManager\", event],\n        (registeredCallbacks) => {\n          return (registeredCallbacks || []).filter((registeredCallback) => registeredCallback.callback !== listener);\n        }\n      );\n    },\n    getListenersAsProps(resourceOrId, scope) {\n      const resource = typeof resourceOrId === \"string\" ? { id: resourceOrId } : resourceOrId;\n      if (!resource || !resource.id) {\n        return {};\n      }\n      const hooks = vault.getResourceMeta(resource.id, \"eventManager\");\n      const props = {};\n      if (hooks && resource) {\n        for (const hook of Object.keys(hooks)) {\n          props[hook] = (e) => {\n            const fullResource = vault.get(resource);\n            for (const { callback, scope: _scope } of hooks[hook] || []) {\n              if (!_scope || scope && _scope.indexOf(scope) !== -1) {\n                callback(e, fullResource);\n              }\n            }\n          };\n        }\n      }\n      return props;\n    }\n  };\n}\nfunction createStylesHelper(vault = compatVault) {\n  return {\n    applyStyles(resource, scope, styles) {\n      const id = typeof resource === \"string\" ? resource : resource.id;\n      return vault.setMetaValue([id, \"styles\", scope], styles);\n    },\n    getAppliedStyles(resource) {\n      const id = typeof resource === \"string\" ? resource : resource.id;\n      return vault.getResourceMeta(id, \"styles\");\n    }\n  };\n}\nfunction p(i) {\n  return i.endsWith(\"info.json\") ? i : i.endsWith(\"/\") ? `${i}info.json` : `${i}/info.json`;\n}\nconst te = \"http://library.stanford.edu/iiif/image-api/compliance.html#level0\", z = \"http://library.stanford.edu/iiif/image-api/compliance.html#level1\", A = \"http://library.stanford.edu/iiif/image-api/compliance.html#level2\", ne = \"http://library.stanford.edu/iiif/image-api/conformance.html#level0\", E = \"http://library.stanford.edu/iiif/image-api/conformance.html#level1\", b = \"http://library.stanford.edu/iiif/image-api/conformance.html#level2\", re = \"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0\", L = \"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1\", M = \"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2\", se = \"http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0\", W = \"http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1\", j = \"http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2\", ae = \"http://iiif.io/api/image/1/level0.json\", oe = \"http://iiif.io/api/image/1/profiles/level0.json\", $ = \"http://iiif.io/api/image/1/level1.json\", C = \"http://iiif.io/api/image/1/profiles/level1.json\", P = \"http://iiif.io/api/image/1/level2.json\", B = \"http://iiif.io/api/image/1/profiles/level2.json\", fe = \"http://iiif.io/api/image/2/level0.json\", le = \"http://iiif.io/api/image/2/profiles/level0.json\", N = \"http://iiif.io/api/image/2/level1.json\", R = \"http://iiif.io/api/image/2/profiles/level1.json\", H = \"http://iiif.io/api/image/2/level2.json\", T = \"http://iiif.io/api/image/2/profiles/level2.json\", he = \"level0\", G = \"level1\", k = \"level2\", ue = \"http://iiif.io/api/image/2/level0\", Q = \"http://iiif.io/api/image/2/level1\", V = \"http://iiif.io/api/image/2/level2\", D = [V, A, b, M, j, P, B, H, T, k], U = [...D, Q, z, E, L, W, $, C, N, R, G], J = [ue, Q, V, te, z, A, ne, E, b, re, L, M, se, W, j, ae, oe, $, C, P, B, fe, le, N, R, H, T, he, G, k], ce = { extraFormats: [\"jpg\"], extraQualities: [\"default\"], extraFeatures: [\"sizeByWhListed\"] }, de = { extraFormats: [\"jpg\"], extraQualities: [\"default\"], extraFeatures: [\"baseUriRedirect\", \"cors\", \"jsonldMediaType\", \"regionByPx\", \"regionSquare\", \"sizeByWhListed\", \"sizeByH\", \"sizeByW\", \"sizeByWh\"] }, ge = { extraFormats: [\"jpg\", \"png\"], extraQualities: [\"default\"], extraFeatures: [\"baseUriRedirect\", \"cors\", \"jsonldMediaType\", \"regionByPct\", \"regionByPx\", \"regionSquare\", \"rotationBy90s\", \"sizeByWhListed\", \"sizeByConfinedWh\", \"sizeByH\", \"sizeByPct\", \"sizeByW\", \"sizeByWh\"] };\nfunction pe(i) {\n  return D.indexOf(i) !== -1 ? ge : U.indexOf(i) !== -1 ? de : ce;\n}\nfunction K(i) {\n  const e = i ? Array.isArray(i.profile) ? i.profile : [i.profile] : [], t = { extraQualities: [], extraFormats: [], extraFeatures: [] };\n  for (let n of e)\n    if (typeof n == \"string\" && (n = pe(n)), !!n) {\n      if (n.formats)\n        for (const r of n.formats)\n          t.extraFormats.indexOf(r) === -1 && t.extraFormats.push(r);\n      if (n.qualities)\n        for (const r of n.qualities)\n          t.extraQualities.indexOf(r) === -1 && t.extraQualities.push(r);\n      if (n.supports)\n        for (const r of n.supports)\n          t.extraFeatures.indexOf(r) === -1 && t.extraFeatures.push(r);\n      if (n.maxHeight && (t.maxHeight = n.maxHeight), n.maxWidth && (t.maxWidth = n.maxWidth), n.maxArea && (t.maxArea = n.maxArea), n.extraFormats)\n        for (const r of n.extraFormats)\n          t.extraFormats.indexOf(r) === -1 && t.extraFormats.push(r);\n      if (n.extraQualities)\n        for (const r of n.extraQualities)\n          t.extraQualities.indexOf(r) === -1 && t.extraQualities.push(r);\n      if (n.extraFeatures)\n        for (const r of n.extraFeatures)\n          t.extraFeatures.indexOf(r) === -1 && t.extraFeatures.push(r);\n      n.maxHeight && (t.maxHeight = n.maxHeight), n.maxWidth && (t.maxWidth = n.maxWidth), n.maxArea && (t.maxArea = n.maxArea);\n    }\n  if (i.extraFormats)\n    for (const n of i.extraFormats)\n      t.extraFormats.indexOf(n) === -1 && t.extraFormats.push(n);\n  if (i.extraFeatures)\n    for (const n of i.extraFeatures)\n      t.extraFeatures.indexOf(n) === -1 && t.extraFeatures.push(n);\n  if (i.extraQualities)\n    for (const n of i.extraQualities)\n      t.extraQualities.indexOf(n) === -1 && t.extraQualities.push(n);\n  return t;\n}\nfunction me(i) {\n  try {\n    if (i === \"full\")\n      return { full: true };\n    if (i === \"square\")\n      return { square: true };\n    const e = i.startsWith(\"pct:\"), n = i.substr(e ? 4 : 0).split(\",\").map((r) => parseFloat(r));\n    return { x: n[0], y: n[1], w: n[2], h: n[3], percent: e };\n  } catch {\n    throw new Error(\"Expected 'full', 'square' or 'x,y,w,h'. Found \" + i);\n  }\n}\nfunction xe(i) {\n  const e = { upscaled: false, max: false, confined: false };\n  if (i[0] === \"^\" && (e.upscaled = true, i = i.slice(1)), i === \"max\" || i === \"full\")\n    return e.max = true, e.serialiseAsFull = i === \"full\", e;\n  if (i[0] === \"!\" && (e.confined = true, i = i.slice(1)), i[0] === \"p\")\n    return e.percentScale = parseFloat(i.slice(4)), e;\n  const t = i.split(\",\").map((n) => n.trim());\n  return t.length && (t[0] !== \"\" && (e.width = parseInt(t[0], 10)), t[1] !== \"\" ? (e.height = parseInt(t[1], 10), e.version = 2) : e.version = 3), e;\n}\nfunction Ie(i) {\n  const e = { angle: 0 };\n  if (i[0] === \"!\" && (e.mirror = true, i = i.substr(1)), e.angle = parseFloat(i) % 360, Number.isNaN(e.angle))\n    throw new Error(`Invalid rotation ${i}`);\n  return e;\n}\nfunction ye(i, e = \"\") {\n  const t = i.match(/^(([a-zA-Z]+):\\/\\/([^/]+))?((.*)+)/);\n  if (!t)\n    throw new Error(`Invalid or unknown input ${i}`);\n  const n = t[2], r = t[3];\n  let s = t[4];\n  if (s[0] === \"/\" && (s = s.substr(1)), e.length > 0) {\n    if (e[0] === \"/\" && (e = e.substr(1)), e !== s.substr(0, e.length))\n      throw new Error(`Path does not start with prefix (path: ${s}, prefix: ${e})`);\n    s = s.substr(e.length);\n  }\n  return { scheme: n, server: r, path: s, prefix: e };\n}\nfunction _e(i, e = \"\") {\n  const { path: t, scheme: n, server: r, prefix: s } = ye(i, e), a = t.split(\"/\").reverse(), [o, f, u, l, ...d] = a, g = d.reverse().filter(Boolean).join(\"/\");\n  if (a.length === 1 || o === \"\")\n    return { type: \"base\", scheme: n, server: r, prefix: s, identifier: g };\n  if (o === \"info.json\") {\n    const [, ...c] = a;\n    return { type: \"info\", scheme: n, server: r, prefix: s, identifier: c.reverse().filter(Boolean).join(\"/\") };\n  }\n  const m = o.split(\".\");\n  return { type: \"image\", scheme: n, server: r, prefix: s, identifier: g, originalPath: t, region: me(l), size: xe(u), rotation: Ie(f), quality: m[0], format: m[1] };\n}\nfunction we(i) {\n  const e = _e(p(i.id));\n  if (e.type !== \"info\")\n    throw new Error(\"Invalid service URL\");\n  const t = K(i);\n  return { identifier: e.identifier, originalPath: \"\", server: e.server, prefix: e.prefix, scheme: e.scheme, type: \"image\", quality: t.extraQualities.indexOf(\"default\") === -1 ? t.extraQualities[0] : \"default\", region: { full: true }, size: { max: true, upscaled: false, confined: false }, format: \"jpg\", rotation: { angle: 0 } };\n}\nfunction Se(i, e, t) {\n  const n = t.length, r = [];\n  for (let s = 0; s < n; s++) {\n    const o = t[s].width;\n    r.push(i / o);\n  }\n  return r;\n}\nfunction ve(i, e, t) {\n  const n = t.length, r = [];\n  for (let s = 0; s < n; s++) {\n    const a = t[s];\n    r.push({ width: Math.floor(i / a), height: Math.floor(e / a) });\n  }\n  return r;\n}\nfunction h(i) {\n  if (i[\"@id\"])\n    return i[\"@id\"];\n  if (i.id)\n    return i.id;\n}\nfunction w(i) {\n  if (!i || !i.profile || !h(i))\n    return false;\n  const e = Array.isArray(i.profile) ? i.profile : [i.profile];\n  for (const t of e)\n    if (typeof t == \"string\" && J.indexOf(t) !== -1)\n      return true;\n  return false;\n}\nfunction Fe(i) {\n  if (!w(i))\n    return false;\n  const e = Array.isArray(i.profile) ? i.profile : [i.profile];\n  for (const t of e)\n    if (typeof t == \"string\") {\n      if (U.indexOf(t) !== -1)\n        return true;\n    } else {\n      const n = [...t.supports || [], ...t.extraFeatures || []];\n      if (n.indexOf(\"regionByPx\") !== -1 && (n.indexOf(\"sizeByW\") !== -1 || n.indexOf(\"sizeByWh\") !== -1))\n        return true;\n    }\n  return false;\n}\nfunction v(i, e) {\n  if (e && e.profile) {\n    const t = e.profile;\n    if (t) {\n      const n = Array.isArray(t) ? t : [t];\n      return n.includes(`level${i}`) || n.includes(`http://iiif.io/api/image/2/level${i}.json`) || n.includes(`http://iiif.io/api/image/1/level${i}.json`) || n.includes(`http://iiif.io/api/image/1/profiles/level${i}.json`);\n    }\n  }\n  return false;\n}\nfunction F(i) {\n  return w(i) ? v(0, i) ? 0 : v(1, i) ? 1 : v(2, i) ? 2 : null : null;\n}\nfunction X(i) {\n  return (i[\"@context\"] ? Array.isArray(i[\"@context\"]) ? i[\"@context\"] : [i[\"@context\"]] : []).indexOf(\"http://iiif.io/api/image/3/context.json\") !== -1;\n}\nfunction Oe(i) {\n  if (!Fe(i))\n    return [];\n  const e = [], t = Array.isArray(i.profile) ? i.profile : [i.profile], n = t.length;\n  for (let r = 0; r < n; r++) {\n    const s = t[r];\n    if (typeof s != \"string\" && (s.maxHeight || s.maxWidth))\n      return [{ id: h(i), type: \"variable\", minWidth: 0, minHeight: 0, maxHeight: s.maxHeight || s.maxWidth, maxWidth: s.maxWidth || s.maxHeight, level: F(i), version: i[\"@context\"] === \"http://iiif.io/api/image/3/context.json\" ? 3 : 2 }];\n  }\n  if (i.tiles) {\n    const r = i.tiles.length;\n    for (let s = 0; s < r; s++) {\n      const a = i.tiles[s];\n      (a.height || a.width) && e.push({ id: h(i), type: \"variable\", minHeight: 0, minWidth: 0, maxHeight: a.height || a.width, maxWidth: a.width, level: F(i), version: X(i) ? 3 : 2 });\n    }\n  }\n  return e;\n}\nfunction Y(i) {\n  const e = /^.*\\/(full)\\/(((\\d+),(\\d+)?)|max)\\/(\\d+)\\/default\\.(jpg|png|jpeg)$/, t = i.match(e);\n  if (t) {\n    const n = t[1], r = parseInt(t[4], 10), s = parseInt(t[5], 10), a = t[7];\n    if ((n === \"max\" || n === \"full\") && r && s && a)\n      return { type: \"fixed\", id: i, height: s, width: r };\n  }\n  return { type: \"unknown\", id: i };\n}\nfunction ze(i) {\n  if (i[\"@type\"])\n    return i[\"@type\"];\n  if (i.type)\n    return i.type;\n}\nfunction Ae(i) {\n  if (typeof i == \"string\")\n    return Y(i);\n  const e = ze(i);\n  if (e !== \"Image\" && e !== \"sc:Image\")\n    return null;\n  const t = i, n = h(t);\n  return n ? n && t.width && t.height ? { id: n, type: \"fixed\", width: t.width, height: t.height, unsafe: true } : Y(n) : null;\n}\nfunction Ee(i) {\n  return w(i) ? (i && i.sizes ? i.sizes : []).map((e) => ({ id: h(i), type: \"fixed-service\", height: e.height, width: e.width, level: F(i), version: X(i) ? 3 : 2 })) : [];\n}\nfunction q(i) {\n  const e = [], t = i.length;\n  for (let n = 0; n < t; n++) {\n    const r = Ee(i[n]);\n    r.length && e.push(...r);\n    const s = Oe(i[n]);\n    s.length && e.push(...s);\n  }\n  return e;\n}\nfunction ee(i) {\n  const e = i.service ? Array.isArray(i.service) ? i.service : [i.service] : [], t = e.length, n = [];\n  for (let r = 0; r < t; r++)\n    w(e[r]) && n.push(e[r]);\n  return n;\n}\nfunction be(i, e = true, t) {\n  const n = [], r = Ae(i);\n  if (r === null)\n    return n;\n  const s = i;\n  if (n.push(r), e && s.width && s.height) {\n    const a = [], o = ee(s);\n    for (const f of o) {\n      const u = { id: h(f), width: s.width, height: s.height };\n      if (t.canLoadSync(u)) {\n        const l = t.loadServiceSync(u);\n        l && (l.height || (l.height = s.height), l.width || (l.width = s.width), a.push(...q([l])));\n      }\n    }\n    if (a.length)\n      return n.push(...a), n;\n  }\n  return s.service && n.push(...q(s.service)), n;\n}\nfunction Le({ x: i = 0, y: e = 0, w: t, h: n, full: r, square: s, percent: a }) {\n  if (r)\n    return \"full\";\n  if (s)\n    return \"square\";\n  if (typeof t > \"u\" || typeof n > \"u\")\n    throw new Error(\"RegionParameter: invalid region\");\n  const o = `${i},${e},${t},${n}`;\n  return a ? `pct:${o}` : o;\n}\nfunction Me({ max: i, percentScale: e, upscaled: t, confined: n, width: r, height: s, serialiseAsFull: a, version: o }) {\n  const f = [];\n  return t && f.push(\"^\"), i ? (f.push(a ? \"full\" : \"max\"), f.join(\"\")) : (n && f.push(\"!\"), e && f.push(`pct:${e}`), r && f.push(`${r}`), f.push(\",\"), s && o === 3 && f.push(`${s}`), f.join(\"\"));\n}\nfunction We(i) {\n  return `${i.mirror ? \"!\" : \"\"}${(i.angle || 0) % 360}`;\n}\nvar Ve = Object.defineProperty, De = Object.defineProperties, Ue = Object.getOwnPropertyDescriptors, je = Object.getOwnPropertySymbols, Je = Object.prototype.hasOwnProperty, Ze = Object.prototype.propertyIsEnumerable, $e = (i, e, t) => e in i ? Ve(i, e, { enumerable: true, configurable: true, writable: true, value: t }) : i[e] = t, x = (i, e) => {\n  for (var t in e || (e = {}))\n    Je.call(e, t) && $e(i, t, e[t]);\n  if (je)\n    for (var t of je(e))\n      Ze.call(e, t) && $e(i, t, e[t]);\n  return i;\n}, I = (i, e) => De(i, Ue(e));\nfunction Ce(i, e) {\n  const t = i.prefix.startsWith(\"/\") ? i.prefix.substr(1) : i.prefix, n = `${i.scheme}://${i.server}/${t ? `${t}/` : \"\"}${i.identifier}`;\n  if (i.type === \"base\")\n    return n;\n  if (i.type === \"info\")\n    return `${n}/info.json`;\n  let { size: r } = i;\n  const { region: s, rotation: a, format: o, quality: f } = i;\n  if (e) {\n    const u = e[\"@context\"] ? Array.isArray(e[\"@context\"]) ? e[\"@context\"] : [e[\"@context\"]] : [], l = u.indexOf(\"http://iiif.io/api/image/2/context.json\") !== -1, d = u.indexOf(\"http://iiif.io/api/image/3/context.json\") !== -1;\n    if ((r.width === e.width && !r.height || r.height === e.height && !r.width || r.width === e.width && r.height === e.height) && (r = I(x({}, r), { max: true })), l && (r.max && !r.serialiseAsFull && (r = I(x({}, r), { serialiseAsFull: true })), !r.max && r.width && r.height && (r = I(x({}, r), { height: void 0 })), r = I(x({}, r), { version: 2 })), d) {\n      if (r.max && r.serialiseAsFull && (r = I(x({}, r), { serialiseAsFull: false })), r.width && !r.height && e.width && e.height) {\n        const g = e.height / e.width;\n        r = I(x({}, r), { height: Math.ceil(r.width * g) });\n      }\n      r = I(x({}, r), { version: 3 });\n    }\n  }\n  return [n, Le(s), Me(r), We(a), `${f}.${o}`].filter(Boolean).join(\"/\");\n}\nfunction O(i, e, t) {\n  const n = we({ \"@context\": i.version === 3 ? \"http://iiif.io/api/image/3/context.json\" : \"http://iiif.io/api/image/2/context.json\", id: p(h(i)), profile: i.level === null || typeof i.level > \"u\" ? \"level0\" : `level${i.level}}`, type: i.version === 3 ? \"ImageService3\" : \"ImageService2\" });\n  if (n.type !== \"image\")\n    throw new Error(\"Invalid service\");\n  return n.size.max = false, n.size.width = e, n.size.height = t, { id: Ce(n), type: \"fixed\", width: e, height: t || i.height / (i.width || 1) * e, unsafe: i.width > e };\n}\nfunction y(i) {\n  const e = i.replace(/(https?:\\/\\/)?(www.)?/i, \"\");\n  return e.indexOf(\"/\") !== -1 ? e.split(\"/\")[0] : e;\n}\nfunction Pe(i, e, t) {\n  const n = i.width ? i.width : i.maxWidth;\n  return t.height <= i.maxHeight && t.width <= i.maxWidth && t.height >= i.minHeight && t.width >= i.minWidth && (!e || Math.abs(t.width - n) < Math.abs(e.width - n));\n}\nfunction Be(i, e) {\n  const t = [], n = Object.assign({ unsafeImageService: false, atAnyCost: true, fallback: true, minHeight: 64, minWidth: 64, maxHeight: 1 / 0, maxWidth: 1 / 0, returnAllOptions: false, preferFixedSize: false, allowUnsafe: false, explain: false, height: 0, width: 0 }, i), r = (l, d = 0) => n.explain ? t.push(new Array(d).fill(0).map((g) => \"    \").join(\"\") + l().trim()) : void 0, s = [], a = [];\n  let o = null;\n  r(() => `Using configuration: ${JSON.stringify(n, null, 2)}`);\n  const f = (l, d) => {\n    if (r(() => \"Swapping choice\", 3), Pe(n, d, l)) {\n      if (n.preferFixedSize && l.unsafe) {\n        r(() => `We found an image that was marked as unsafe, but it was the best size. (${l.id})`, 4), a.push(l);\n        return;\n      }\n      n.returnAllOptions && d && a.push(d), r(() => `We found a new image that was the best size. (${l.id})`, 4), o = l;\n    } else\n      n.returnAllOptions && a.push(l);\n  };\n  r(() => `The input shows we have ${e.length} list(s) of candidates to choose from.`);\n  const u = e.length;\n  for (let l = 0; l < u; l++) {\n    const d = e[l]();\n    r(() => `Candidate group ${l}: ${JSON.stringify(d, null, 2)}`, 1);\n    const g = d.length;\n    r(() => `Checking candidate list number ${l} and found ${g} potential ways of creating image(s)`, 1);\n    for (let m = 0; m < g; m++) {\n      const c = d[m];\n      if (r(() => `-> Checking candidate ${m}`, 1), c.type === \"unknown\" && n.atAnyCost && (r(() => `We've found an unknown image type, adding this to the \"last resort\" list`, 2), s.push(c)), c.type === \"fixed\" && (c.unsafe ? (r(() => `We've found an unsafe fixed image type, adding this to the \"last resort\" list`, 2), s.push(c)) : (r(() => \"We've found a fixed size image, checking if it matches the request\", 2), f(c, o))), c.type === \"fixed-service\")\n        if (n.unsafeImageService) {\n          r(() => \"Checking for an image from the tile source, without calculating the right height and width (unsafeImageService)\", 2);\n          const S = O(c, n.width, n.height);\n          f(S, o);\n        } else {\n          r(() => \"Checking for an image from the tile source 3\", 2);\n          const S = O(c, c.width, c.height);\n          f(S, o);\n        }\n      if (c.type === \"variable\" && c.maxWidth) {\n        const S = O({ id: c.id, type: \"fixed-service\", width: c.maxWidth, height: c.maxWidth, level: c.level, version: c.version }, c.maxWidth);\n        f(S, o);\n      }\n    }\n    if (o && !n.returnAllOptions) {\n      if (o.unsafe || n.allowUnsafe)\n        continue;\n      r(() => `We found a match in choice list number ${l}, no searching any more`);\n      break;\n    }\n  }\n  return n.atAnyCost && a.length === 0 ? (r(() => o ? `We found an image! ${o.id} of type ${o.type}` : 'We found no images, but \"atAnyCost\" is set, so returning that'), { best: o || s[0], fallback: s.slice(1), log: t }) : n.returnAllOptions ? (r(() => \"Returning all options that we have found\"), { best: n.atAnyCost ? o || a[0] || s[0] : o || a[0], fallback: [...a, ...s], log: t }) : (r(() => \"Returning the best image that we found, and a fallback\"), { best: o || a[0] || null, fallback: o ? a : a.slice(1), log: t });\n}\nvar qe = Object.defineProperty, ei = Object.defineProperties, ii = Object.getOwnPropertyDescriptors, Ne = Object.getOwnPropertySymbols, ti = Object.prototype.hasOwnProperty, ni = Object.prototype.propertyIsEnumerable, Re = (i, e, t) => e in i ? qe(i, e, { enumerable: true, configurable: true, writable: true, value: t }) : i[e] = t, ri = (i, e) => {\n  for (var t in e || (e = {}))\n    ti.call(e, t) && Re(i, t, e[t]);\n  if (Ne)\n    for (var t of Ne(e))\n      ni.call(e, t) && Re(i, t, e[t]);\n  return i;\n}, si = (i, e) => ei(i, ii(e));\nfunction He(i, e, t) {\n  const n = i > e ? i : e, r = t.length, s = [];\n  for (let a = 0; a < r; a++) {\n    const o = t[a];\n    let f = o.scaleFactors[0], u = n / f;\n    const l = [f];\n    for (; u >= o.width; )\n      f = f * 2, l.push(f), u = u / 2;\n    s.push(si(ri({}, o), { scaleFactors: l }));\n  }\n  return s;\n}\nfunction Te(i, e) {\n  if (i.length !== e.length)\n    return false;\n  if (i.length === 0 && e.length === 0)\n    return true;\n  const t = i.length;\n  let n = true;\n  for (let s = 0; s < t; s++) {\n    const a = i[s], o = e[s];\n    if (a.width !== o.width || a.height !== o.height) {\n      n = false;\n      break;\n    }\n  }\n  if (n)\n    return true;\n  let r = 0;\n  for (let s = 0; s < t; s++)\n    for (let a = 0; a < t; a++)\n      if (i[s].width === e[a].width && i[s].height === e[a].height) {\n        r++;\n        break;\n      }\n  return r === t;\n}\nfunction Ge(i) {\n  return v(0, i);\n}\nvar _ = (i, e, t) => new Promise((n, r) => {\n  var s = (f) => {\n    try {\n      o(t.next(f));\n    } catch (u) {\n      r(u);\n    }\n  }, a = (f) => {\n    try {\n      o(t.throw(f));\n    } catch (u) {\n      r(u);\n    }\n  }, o = (f) => f.done ? n(f.value) : Promise.resolve(f.value).then(s, a);\n  o((t = t.apply(i, e)).next());\n});\nclass ke {\n  constructor() {\n    this.config = { verificationsRequired: 1, approximateServices: true, enableFetching: true, disableThrottling: false }, this.fetchingCount = 0, this.imageServices = {}, this.knownImageServers = {};\n  }\n  setConfig(e) {\n    Object.assign(this.config, e);\n  }\n  sample(e, t, n = true) {\n    const r = y(h(e)), s = p(h(e)), a = this.knownImageServers[r];\n    return this.imageServices[s] = Object.assign(e, { real: true }), !a && e.tiles && !Ge(e) ? (this.knownImageServers[r] = { verifications: 0, malformed: false, root: r, preLoaded: n, sampledId: h(e), verified: false, server: null, result: { context: e[\"@context\"] || [], sampledProfile: e.profile, resourceServiceRatio: t && e.height ? t.height / e.height : 1, sampledSizes: e.sizes || [], sizeRatios: Se(e.width, e.height, e.sizes || []), sampledTiles: e.tiles || [] } }, true) : this.verify(e);\n  }\n  preLoad(e, t = true) {\n    this.knownImageServers[e.root] = e, t && (this.knownImageServers[e.root].malformed = false, this.knownImageServers[e.root].verifications = this.config.verificationsRequired);\n  }\n  predict(e, t = false, n = false) {\n    const r = e == null ? void 0 : e.source, s = y(h(e)), a = this.knownImageServers[s];\n    if (!a || !a.result || !((r == null ? void 0 : r.height) || e.height) || !((r == null ? void 0 : r.width) || e.width) || !n && (a.malformed || a.verifications < this.config.verificationsRequired) || Ge(e.source))\n      return null;\n    const o = p(h(e));\n    return this.imageServices[o] || (this.imageServices[o] = { \"@context\": a.result.context, \"@id\": h(e), id: h(e), protocol: \"http://iiif.io/api/image\", tiles: (r == null ? void 0 : r.tiles) || He(e.width, e.height, a.result.sampledTiles), sizes: (r == null ? void 0 : r.sizes) || ve(Math.round(e.width / a.result.resourceServiceRatio), Math.round(e.height / a.result.resourceServiceRatio), a.result.sizeRatios), profile: (r == null ? void 0 : r.profile) || a.result.sampledProfile, height: (r == null ? void 0 : r.height) || e.height, width: (r == null ? void 0 : r.width) || e.width, real: false }), this.imageServices[o];\n  }\n  getThumbnailFromResource(e, t) {\n    return _(this, arguments, function* (n, r, s = true, a = []) {\n      const o = n ? yield this.getImageCandidates(n, s) : [];\n      return Be(r, [() => a, () => o]);\n    });\n  }\n  getImageCandidates(e, t = true) {\n    return _(this, null, function* () {\n      const n = e;\n      if (t && n.height && n.width) {\n        const r = ee(n);\n        for (const s of r) {\n          const a = { id: h(s), width: s.width ? s.width : n.width, height: s.height ? s.height : n.height, source: s };\n          yield this.loadService(a);\n        }\n      }\n      return be(e, t, this);\n    });\n  }\n  verify(e) {\n    return _(this, null, function* () {\n      const t = this.predict(e, false, true), n = yield this.fetchService(h(e));\n      if (!t)\n        return false;\n      const r = t.height === n.height && t.width === n.width && t[\"@context\"] === n[\"@context\"] && Te(t.sizes || [], n.sizes || []);\n      if (r) {\n        const s = y(h(e));\n        this.knownImageServers[s].verifications += 1, this.knownImageServers[s].verifications >= this.config.verificationsRequired && (this.knownImageServers[s].verified = true);\n      }\n      return r;\n    });\n  }\n  canLoadSync(e) {\n    const t = typeof e == \"string\" ? e : h(e), n = p(t);\n    if (this.imageServices[n])\n      return true;\n    const r = this.knownImageServers[y(t)];\n    return r && !r.malformed && r.verifications >= this.config.verificationsRequired;\n  }\n  markAsMalformed(e) {\n    return _(this, null, function* () {\n      return this.knownImageServers[y(h(e))].malformed = true, this.loadService(e, true);\n    });\n  }\n  fetchService(e, t = false) {\n    return _(this, null, function* () {\n      const n = p(e);\n      if (this.imageServices[n] && (!t || this.imageServices[n].real))\n        return this.imageServices[n];\n      if (!this.config.enableFetching)\n        throw new Error(\"Fetching is not enabled\");\n      const r = yield this.fetch(n).then((s) => s.json());\n      return !r.id && r[\"@id\"] && (r.id = r[\"@id\"]), r.id !== e && (r.id = e, r[\"@id\"] && (r[\"@id\"] = e)), this.imageServices[n] = Object.assign(r, { real: true }), this.imageServices[n];\n    });\n  }\n  fetch(e, t) {\n    return _(this, null, function* () {\n      return fetch(e, t);\n    });\n  }\n  loadService(e, t = false) {\n    return _(this, null, function* () {\n      if (!this.config.disableThrottling) {\n        let s = true;\n        for (; s; )\n          if (this.fetchingCount >= this.config.verificationsRequired)\n            yield new Promise((a) => setTimeout(a, 500));\n          else {\n            s = false;\n            break;\n          }\n      }\n      const n = this.knownImageServers[y(h(e))];\n      if (n && !n.malformed && !t) {\n        yield n.result;\n        const s = this.loadServiceSync(e);\n        if (s)\n          return s;\n      }\n      this.fetchingCount++;\n      const r = yield this.fetchService(h(e), t);\n      return this.fetchingCount--, r.real && this.sample(r, e), r;\n    });\n  }\n  loadServiceSync(e) {\n    const t = p(h(e));\n    return this.imageServices[t] ? this.imageServices[t] : this.predict(e);\n  }\n}\nnew ke();\nfunction createThumbnailHelper(vault = compatVault, dependencies = {}) {\n  const imageServiceLoader = dependencies.imageServiceLoader || new ke();\n  async function getBestThumbnailAtSize(input, request, dereference, candidates = [], dimensions) {\n    const thumbnailNotFound = () => imageServiceLoader.getThumbnailFromResource(void 0, request, dereference, candidates);\n    if (!input) {\n      return await imageServiceLoader.getThumbnailFromResource(void 0, request, dereference, candidates);\n    }\n    if (typeof input === \"string\") {\n      const fixed = Ae(input);\n      if (fixed) {\n        candidates.push(fixed);\n      }\n      return await imageServiceLoader.getThumbnailFromResource(void 0, request, dereference, candidates);\n    }\n    const fullInput = vault.get(input, { skipSelfReturn: false });\n    if (typeof fullInput === \"string\") {\n      return { best: Ae(fullInput), fallback: [], log: [] };\n    }\n    if (!fullInput) {\n      return await thumbnailNotFound();\n    }\n    const parseThumbnail = async (resource) => {\n      if (resource && resource.thumbnail && resource.thumbnail.length) {\n        const thumbnail = vault.get(resource.thumbnail[0]);\n        const potentialThumbnails = await imageServiceLoader.getImageCandidates(thumbnail, dereference);\n        if (potentialThumbnails && potentialThumbnails.length) {\n          candidates.push(...potentialThumbnails);\n        }\n      }\n    };\n    await parseThumbnail(fullInput);\n    switch (fullInput.type) {\n      case \"Annotation\": {\n        const contentResources = Array.isArray(fullInput.body) ? fullInput.body : [fullInput.body];\n        const firstContentResources = vault.get(contentResources[0]);\n        if (dimensions && !firstContentResources.width) {\n          firstContentResources.width = dimensions.width;\n          firstContentResources.height = dimensions.height;\n        }\n        return await imageServiceLoader.getThumbnailFromResource(\n          firstContentResources,\n          request,\n          dereference,\n          candidates\n        );\n      }\n      case \"Canvas\": {\n        const canvas = fullInput;\n        return getBestThumbnailAtSize(canvas.items[0], request, dereference, candidates, {\n          width: canvas.width,\n          height: canvas.height\n        });\n      }\n      case \"AnnotationPage\": {\n        const annotationPage = fullInput;\n        return getBestThumbnailAtSize(annotationPage.items[0], request, dereference, candidates, dimensions);\n      }\n      case \"Choice\": {\n        const choice = fullInput;\n        if (!choice.items || choice.items[0]) {\n          return await thumbnailNotFound();\n        }\n        return getBestThumbnailAtSize(choice.items[0], request, dereference, candidates, dimensions);\n      }\n      case \"Collection\": {\n        const collection = fullInput;\n        const firstManifest = collection.items[0];\n        if (!firstManifest) {\n          return await thumbnailNotFound();\n        }\n        return getBestThumbnailAtSize(firstManifest, request, dereference, candidates, dimensions);\n      }\n      case \"Manifest\": {\n        const manifest = fullInput;\n        const firstCanvas = manifest.items[0];\n        if (!firstCanvas) {\n          return await thumbnailNotFound();\n        }\n        return getBestThumbnailAtSize(firstCanvas, request, dereference, candidates, dimensions);\n      }\n      case \"SpecificResource\":\n      case \"Image\":\n      case \"Dataset\":\n      case \"Sound\":\n      case \"Text\":\n      case \"TextualBody\":\n      case \"Video\":\n        if (dimensions && !fullInput.width) {\n          fullInput.width = dimensions.width;\n          fullInput.height = dimensions.height;\n        }\n        return imageServiceLoader.getThumbnailFromResource(fullInput, request, dereference, candidates);\n      case \"Service\":\n      case \"Range\":\n      case \"AnnotationCollection\":\n      case \"CanvasReference\":\n      case \"ContentResource\":\n        return await thumbnailNotFound();\n    }\n    return await thumbnailNotFound();\n  }\n  return {\n    getBestThumbnailAtSize\n  };\n}\nfunction getClosestLanguage(i18nLanguage, languages, i18nLanguages = [], strictFallback = false) {\n  if (!i18nLanguage || !languages || languages.length === 0) {\n    return void 0;\n  }\n  if (languages.length === 1) {\n    return languages[0];\n  }\n  if (languages.indexOf(i18nLanguage) !== -1) {\n    return i18nLanguage;\n  }\n  const root = i18nLanguage.indexOf(\"-\") !== -1 ? i18nLanguage.slice(0, i18nLanguage.indexOf(\"-\")) : null;\n  if (root && languages.indexOf(root) !== -1) {\n    return root;\n  }\n  for (const lang of i18nLanguages) {\n    if (languages.indexOf(lang) !== -1) {\n      return lang;\n    }\n  }\n  if (!strictFallback) {\n    const inverseRoot = languages.map((l) => l.indexOf(\"-\") !== -1 ? l.slice(0, l.indexOf(\"-\")) : null);\n    const inverseIdx = inverseRoot.indexOf(i18nLanguage);\n    if (inverseIdx !== -1) {\n      return languages[inverseIdx];\n    }\n    for (const lang of i18nLanguages) {\n      const root2 = lang.indexOf(\"-\") !== -1 ? lang.slice(0, lang.indexOf(\"-\")) : null;\n      const inverseIdx2 = root2 ? languages.indexOf(root2) : -1;\n      if (inverseIdx2 !== -1) {\n        return languages[inverseIdx2];\n      }\n    }\n  }\n  if (languages.indexOf(\"none\") !== -1) {\n    return \"none\";\n  }\n  if (languages.indexOf(\"@none\") !== -1) {\n    return \"@none\";\n  }\n  return languages[0];\n}\nfunction buildLocaleString(inputText, i18nLanguage, options = {}) {\n  const { strictFallback = false, defaultText = \"\", separator = \"\\n\", fallbackLanguages = [], closest } = options;\n  const languages = Object.keys(inputText || {});\n  const language = closest ? i18nLanguage : getClosestLanguage(i18nLanguage, languages, fallbackLanguages, strictFallback);\n  if (!inputText) {\n    return defaultText;\n  }\n  if (typeof inputText === \"string\") {\n    return inputText;\n  }\n  const candidateText = language ? inputText[language] : void 0;\n  if (candidateText) {\n    if (typeof candidateText === \"string\") {\n      return candidateText;\n    }\n    return candidateText.join(separator);\n  }\n  return \"\";\n}\nfunction getValue(inputText, options = {}) {\n  return buildLocaleString(inputText, typeof navigator !== \"undefined\" ? navigator.language : void 0, options);\n}\nvar _slicedToArray = function() {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e2 = void 0;\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n        if (i && _arr.length === i)\n          break;\n      }\n    } catch (err) {\n      _d = true;\n      _e2 = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"])\n          _i[\"return\"]();\n      } finally {\n        if (_d)\n          throw _e2;\n      }\n    }\n    return _arr;\n  }\n  return function(arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if (Symbol.iterator in Object(arr)) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\nvar TAU = Math.PI * 2;\nvar mapToEllipse = function mapToEllipse2(_ref, rx, ry, cosphi, sinphi, centerx, centery) {\n  var x2 = _ref.x, y2 = _ref.y;\n  x2 *= rx;\n  y2 *= ry;\n  var xp = cosphi * x2 - sinphi * y2;\n  var yp = sinphi * x2 + cosphi * y2;\n  return {\n    x: xp + centerx,\n    y: yp + centery\n  };\n};\nvar approxUnitArc = function approxUnitArc2(ang1, ang2) {\n  var a = ang2 === 1.5707963267948966 ? 0.551915024494 : ang2 === -1.5707963267948966 ? -0.551915024494 : 4 / 3 * Math.tan(ang2 / 4);\n  var x1 = Math.cos(ang1);\n  var y1 = Math.sin(ang1);\n  var x2 = Math.cos(ang1 + ang2);\n  var y2 = Math.sin(ang1 + ang2);\n  return [{\n    x: x1 - y1 * a,\n    y: y1 + x1 * a\n  }, {\n    x: x2 + y2 * a,\n    y: y2 - x2 * a\n  }, {\n    x: x2,\n    y: y2\n  }];\n};\nvar vectorAngle = function vectorAngle2(ux, uy, vx, vy) {\n  var sign = ux * vy - uy * vx < 0 ? -1 : 1;\n  var dot = ux * vx + uy * vy;\n  if (dot > 1) {\n    dot = 1;\n  }\n  if (dot < -1) {\n    dot = -1;\n  }\n  return sign * Math.acos(dot);\n};\nvar getArcCenter = function getArcCenter2(px, py, cx, cy, rx, ry, largeArcFlag, sweepFlag, sinphi, cosphi, pxp, pyp) {\n  var rxsq = Math.pow(rx, 2);\n  var rysq = Math.pow(ry, 2);\n  var pxpsq = Math.pow(pxp, 2);\n  var pypsq = Math.pow(pyp, 2);\n  var radicant = rxsq * rysq - rxsq * pypsq - rysq * pxpsq;\n  if (radicant < 0) {\n    radicant = 0;\n  }\n  radicant /= rxsq * pypsq + rysq * pxpsq;\n  radicant = Math.sqrt(radicant) * (largeArcFlag === sweepFlag ? -1 : 1);\n  var centerxp = radicant * rx / ry * pyp;\n  var centeryp = radicant * -ry / rx * pxp;\n  var centerx = cosphi * centerxp - sinphi * centeryp + (px + cx) / 2;\n  var centery = sinphi * centerxp + cosphi * centeryp + (py + cy) / 2;\n  var vx1 = (pxp - centerxp) / rx;\n  var vy1 = (pyp - centeryp) / ry;\n  var vx2 = (-pxp - centerxp) / rx;\n  var vy2 = (-pyp - centeryp) / ry;\n  var ang1 = vectorAngle(1, 0, vx1, vy1);\n  var ang2 = vectorAngle(vx1, vy1, vx2, vy2);\n  if (sweepFlag === 0 && ang2 > 0) {\n    ang2 -= TAU;\n  }\n  if (sweepFlag === 1 && ang2 < 0) {\n    ang2 += TAU;\n  }\n  return [centerx, centery, ang1, ang2];\n};\nvar arcToBezier = function arcToBezier2(_ref2) {\n  var px = _ref2.px, py = _ref2.py, cx = _ref2.cx, cy = _ref2.cy, rx = _ref2.rx, ry = _ref2.ry, _ref2$xAxisRotation = _ref2.xAxisRotation, xAxisRotation = _ref2$xAxisRotation === void 0 ? 0 : _ref2$xAxisRotation, _ref2$largeArcFlag = _ref2.largeArcFlag, largeArcFlag = _ref2$largeArcFlag === void 0 ? 0 : _ref2$largeArcFlag, _ref2$sweepFlag = _ref2.sweepFlag, sweepFlag = _ref2$sweepFlag === void 0 ? 0 : _ref2$sweepFlag;\n  var curves = [];\n  if (rx === 0 || ry === 0) {\n    return [];\n  }\n  var sinphi = Math.sin(xAxisRotation * TAU / 360);\n  var cosphi = Math.cos(xAxisRotation * TAU / 360);\n  var pxp = cosphi * (px - cx) / 2 + sinphi * (py - cy) / 2;\n  var pyp = -sinphi * (px - cx) / 2 + cosphi * (py - cy) / 2;\n  if (pxp === 0 && pyp === 0) {\n    return [];\n  }\n  rx = Math.abs(rx);\n  ry = Math.abs(ry);\n  var lambda = Math.pow(pxp, 2) / Math.pow(rx, 2) + Math.pow(pyp, 2) / Math.pow(ry, 2);\n  if (lambda > 1) {\n    rx *= Math.sqrt(lambda);\n    ry *= Math.sqrt(lambda);\n  }\n  var _getArcCenter = getArcCenter(px, py, cx, cy, rx, ry, largeArcFlag, sweepFlag, sinphi, cosphi, pxp, pyp), _getArcCenter2 = _slicedToArray(_getArcCenter, 4), centerx = _getArcCenter2[0], centery = _getArcCenter2[1], ang1 = _getArcCenter2[2], ang2 = _getArcCenter2[3];\n  var ratio = Math.abs(ang2) / (TAU / 4);\n  if (Math.abs(1 - ratio) < 1e-7) {\n    ratio = 1;\n  }\n  var segments = Math.max(Math.ceil(ratio), 1);\n  ang2 /= segments;\n  for (var i = 0; i < segments; i++) {\n    curves.push(approxUnitArc(ang1, ang2));\n    ang1 += ang2;\n  }\n  return curves.map(function(curve) {\n    var _mapToEllipse = mapToEllipse(curve[0], rx, ry, cosphi, sinphi, centerx, centery), x1 = _mapToEllipse.x, y1 = _mapToEllipse.y;\n    var _mapToEllipse2 = mapToEllipse(curve[1], rx, ry, cosphi, sinphi, centerx, centery), x2 = _mapToEllipse2.x, y2 = _mapToEllipse2.y;\n    var _mapToEllipse3 = mapToEllipse(curve[2], rx, ry, cosphi, sinphi, centerx, centery), x3 = _mapToEllipse3.x, y3 = _mapToEllipse3.y;\n    return { x1, y1, x2, y2, x: x3, y: y3 };\n  });\n};\nvar parseSvgPath = parse;\nvar length = { a: 7, c: 6, h: 1, l: 2, m: 2, q: 4, s: 4, t: 2, v: 1, z: 0 };\nvar segment = /([astvzqmhlc])([^astvzqmhlc]*)/ig;\nfunction parse(path) {\n  var data = [];\n  path.replace(segment, function(_2, command, args) {\n    var type = command.toLowerCase();\n    args = parseValues(args);\n    if (type == \"m\" && args.length > 2) {\n      data.push([command].concat(args.splice(0, 2)));\n      type = \"l\";\n      command = command == \"m\" ? \"l\" : \"L\";\n    }\n    while (true) {\n      if (args.length == length[type]) {\n        args.unshift(command);\n        return data.push(args);\n      }\n      if (args.length < length[type])\n        throw new Error(\"malformed path data\");\n      data.push([command].concat(args.splice(0, length[type])));\n    }\n  });\n  return data;\n}\nvar number = /-?[0-9]*\\.?[0-9]+(?:e[-+]?\\d+)?/ig;\nfunction parseValues(args) {\n  var numbers = args.match(number);\n  return numbers ? numbers.map(Number) : [];\n}\nvar absSvgPath = absolutize;\nfunction absolutize(path) {\n  var startX = 0;\n  var startY = 0;\n  var x2 = 0;\n  var y2 = 0;\n  return path.map(function(seg) {\n    seg = seg.slice();\n    var type = seg[0];\n    var command = type.toUpperCase();\n    if (type != command) {\n      seg[0] = command;\n      switch (type) {\n        case \"a\":\n          seg[6] += x2;\n          seg[7] += y2;\n          break;\n        case \"v\":\n          seg[1] += y2;\n          break;\n        case \"h\":\n          seg[1] += x2;\n          break;\n        default:\n          for (var i = 1; i < seg.length; ) {\n            seg[i++] += x2;\n            seg[i++] += y2;\n          }\n      }\n    }\n    switch (command) {\n      case \"Z\":\n        x2 = startX;\n        y2 = startY;\n        break;\n      case \"H\":\n        x2 = seg[1];\n        break;\n      case \"V\":\n        y2 = seg[1];\n        break;\n      case \"M\":\n        x2 = startX = seg[1];\n        y2 = startY = seg[2];\n        break;\n      default:\n        x2 = seg[seg.length - 2];\n        y2 = seg[seg.length - 1];\n    }\n    return seg;\n  });\n}\nfunction parseAndNormalizeSvgPath(path) {\n  const parsed = parseSvgPath(path);\n  const absolute = absSvgPath(parsed);\n  let prevCmd;\n  let startX = 0;\n  let startY = 0;\n  let bezierX = 0;\n  let bezierY = 0;\n  let quadX;\n  let quadY;\n  let x2 = 0;\n  let y2 = 0;\n  const out = [];\n  for (let i = 0; i < absolute.length; i++) {\n    let seg = absolute[i];\n    const cmd = seg[0];\n    switch (cmd) {\n      case \"M\":\n        startX = seg[1];\n        startY = seg[2];\n        break;\n      case \"H\":\n        seg = [\"L\", seg[1], startY];\n        break;\n      case \"V\":\n        seg = [\"L\", startX, seg[1]];\n        break;\n      case \"S\":\n        {\n          let cx = x2;\n          let cy = y2;\n          if (prevCmd === \"C\" || prevCmd == \"S\") {\n            cx += cx - bezierX;\n            cy += cy - bezierY;\n          }\n          seg = [\"C\", cx, cy, seg[1], seg[2], seg[3], seg[4]];\n        }\n        break;\n      case \"T\":\n        if (prevCmd === \"Q\" || prevCmd == \"T\") {\n          quadX = x2 * 2 - quadX;\n          quadY = y2 * 2 - quadY;\n        } else {\n          quadX = x2;\n          quadY = y2;\n        }\n        seg = [\"Q\", quadX, quadY, seg[1], seg[2]];\n        break;\n      case \"Q\":\n        quadX = seg[1];\n        quadY = seg[2];\n        break;\n      case \"A\":\n        {\n          const curves = arcToBezier({\n            px: x2,\n            py: y2,\n            cx: seg[6],\n            cy: seg[7],\n            rx: seg[1],\n            ry: seg[2],\n            xAxisRotation: seg[3],\n            largeArcFlag: seg[4],\n            sweepFlag: seg[5]\n          });\n          if (!curves.length) {\n            continue;\n          }\n          for (const [j2, curve] of curves.entries()) {\n            seg = [\"C\", curve.x1, curve.y1, curve.x2, curve.y2, curve.x, curve.y];\n            if (j2 < curves.length - 1) {\n              out.push(seg);\n            }\n          }\n          seg = seg;\n        }\n        break;\n      case \"Z\":\n        seg = [\"L\", startX, startY];\n        break;\n    }\n    prevCmd = cmd;\n    x2 = seg[seg.length - 2];\n    y2 = seg[seg.length - 1];\n    if ([\"C\", \"Q\", \"A\"].indexOf(cmd) > -1) {\n      bezierX = seg[seg.length - 4];\n      bezierY = seg[seg.length - 3];\n    } else {\n      bezierX = x2;\n      bezierY = y2;\n    }\n    out.push(seg);\n  }\n  return out;\n}\n/** Code to \"flatten\" quadratic and cubic Bézier curves to polylines.\n *\n * All code in this module is based on JavaScript code by Raph Levien, published on his blog at\n * https://raphlinus.github.io/.\n * I merely changed the structure a bit, removed some unneeded parts and added some comments and type hints.\n *\n * Flattening of quadratic Bézier curves:\n * - Article: https://raphlinus.github.io/graphics/curves/2019/12/23/flatten-quadbez.html\n * - Code: https://github.com/raphlinus/raphlinus.github.io/blob/master/_posts/2019-12-23-flatten-quadbez.md?plain=1#L73-L212\n *\n * Flattening of cubic Bézier curves: https://levien.com/tmp/flatten.html\n *\n * Note that the code in this module has a different license than the rest of the package,\n * due to the inclusion of Apache-licensed third party code.\n *\n * @license\n * Copyright 2022 Johannes Baiter <johannes.baiter@gmail.com>\n * Copyright 2019, 2022 Raph Levien <raph.levien@gmail.com>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nfunction flattenQuadraticBezier(start, control, end, tolerance = 1) {\n  return new QuadraticBezier(start, control, end).subdivide(tolerance);\n}\nfunction flattenCubicBezier(start, startControl, end, endControl, tolerance = 1) {\n  return new CubicBezier(\n    new Float64Array([start.x, start.y, startControl.x, startControl.y, end.x, end.y, endControl.x, endControl.y])\n  ).subdivide(tolerance);\n}\nfunction hypot2(p2) {\n  return p2.x * p2.x + p2.y * p2.y;\n}\nfunction approx_myint(x2) {\n  const d = 0.67;\n  return x2 / (1 - d + Math.pow(Math.pow(d, 4) + 0.25 * x2 * x2, 0.25));\n}\nfunction approx_inv_myint(x2) {\n  const b2 = 0.39;\n  return x2 * (1 - b2 + Math.sqrt(b2 * b2 + 0.25 * x2 * x2));\n}\nclass QuadraticBezier {\n  constructor(start, control, end) {\n    this.start = start;\n    this.control = control;\n    this.end = end;\n  }\n  eval(t) {\n    const mt = 1 - t;\n    return {\n      x: this.start.x * mt * mt + 2 * this.control.x * mt * t + this.end.x * t * t,\n      y: this.start.y * mt * mt + 2 * this.control.y * mt * t + this.end.y * t * t\n    };\n  }\n  mapToBasic() {\n    const { x: x0, y: y0 } = this.start;\n    const { x: x1, y: y1 } = this.control;\n    const { x: x2, y: y2 } = this.end;\n    const ddx = 2 * x1 - x0 - x2;\n    const ddy = 2 * y1 - y0 - y2;\n    const u0 = (x1 - x0) * ddx + (y1 - y0) * ddy;\n    const u2 = (x2 - x1) * ddx + (y2 - y1) * ddy;\n    const cross = (x2 - x0) * ddy - (y2 - y0) * ddx;\n    const paramX0 = u0 / cross;\n    const paramX2 = u2 / cross;\n    const scale = Math.abs(cross) / (Math.hypot(ddx, ddy) * Math.abs(paramX2 - paramX0));\n    return { x0, x2, scale, cross };\n  }\n  subdivide(tolerance) {\n    const params = this.mapToBasic();\n    const a0 = approx_myint(params.x0);\n    const a2 = approx_myint(params.x2);\n    const count = 0.5 * Math.abs(a2 - a0) * Math.sqrt(params.scale / tolerance);\n    const n = Math.ceil(count);\n    const u0 = approx_inv_myint(a0);\n    const u2 = approx_inv_myint(a2);\n    const tValues = [0];\n    for (let i = 1; i < n; i++) {\n      const u = approx_inv_myint(a0 + (a2 - a0) * i / n);\n      const t = (u - u0) / (u2 - u0);\n      tValues.push(t);\n    }\n    tValues.push(1);\n    return tValues.map((t) => this.eval(t));\n  }\n}\nclass CubicBezier {\n  constructor(coords) {\n    this.c = coords;\n  }\n  weightsum(c0, c1, c2, c3) {\n    const x2 = c0 * this.c[0] + c1 * this.c[2] + c2 * this.c[4] + c3 * this.c[6];\n    const y2 = c0 * this.c[1] + c1 * this.c[3] + c2 * this.c[5] + c3 * this.c[7];\n    return { x: x2, y: y2 };\n  }\n  eval(t) {\n    const mt = 1 - t;\n    const c0 = mt * mt * mt;\n    const c1 = 3 * mt * mt * t;\n    const c2 = 3 * mt * t * t;\n    const c3 = t * t * t;\n    return this.weightsum(c0, c1, c2, c3);\n  }\n  deriv(t) {\n    const mt = 1 - t;\n    const c0 = -3 * mt * mt;\n    const c3 = 3 * t * t;\n    const c1 = -6 * t * mt - c0;\n    const c2 = 6 * t * mt - c3;\n    return this.weightsum(c0, c1, c2, c3);\n  }\n  midpoint_quadbez() {\n    const p1 = this.weightsum(-0.25, 0.75, 0.75, -0.25);\n    return new QuadraticBezier({ x: this.c[0], y: this.c[1] }, p1, { x: this.c[6], y: this.c[7] });\n  }\n  subsegment(t0, t1) {\n    const c = new Float64Array(8);\n    const p0 = this.eval(t0);\n    const p3 = this.eval(t1);\n    c[0] = p0.x;\n    c[1] = p0.y;\n    const scale = (t1 - t0) / 3;\n    const d1 = this.deriv(t0);\n    c[2] = p0.x + scale * d1.x;\n    c[3] = p0.y + scale * d1.y;\n    const d2 = this.deriv(t1);\n    c[4] = p3.x - scale * d2.x;\n    c[5] = p3.y - scale * d2.y;\n    c[6] = p3.x;\n    c[7] = p3.y;\n    return new CubicBezier(c);\n  }\n  subdivide(tol) {\n    const tol1 = 0.1 * tol;\n    const tol2 = tol - tol1;\n    const sqrt_tol2 = Math.sqrt(tol2);\n    const err2 = hypot2(this.weightsum(1, -3, 3, -1));\n    const n_quads = Math.ceil(Math.pow(err2 / (432 * tol1 * tol1), 1 / 6));\n    const quads = [];\n    let sum = 0;\n    for (let i2 = 0; i2 < n_quads; i2++) {\n      const t0 = i2 / n_quads;\n      const t1 = (i2 + 1) / n_quads;\n      const quad = this.subsegment(t0, t1).midpoint_quadbez();\n      const params = quad.mapToBasic();\n      const a0 = approx_myint(params.x0);\n      const a2 = approx_myint(params.x2);\n      const scale = Math.sqrt(params.scale);\n      let val2 = Math.abs(a2 - a0) * scale;\n      if (Math.sign(params.x0) != Math.sign(params.x2)) {\n        const xmin = sqrt_tol2 / scale;\n        const cusp_val = sqrt_tol2 * Math.abs(a2 - a0) / approx_myint(xmin);\n        val2 = Math.max(val2, cusp_val);\n      }\n      quads.push({\n        quad,\n        a0,\n        a2,\n        val: val2\n      });\n      sum += val2;\n    }\n    const count = 0.5 * sum / sqrt_tol2;\n    const n = Math.ceil(count);\n    const result = [{ x: this.c[0], y: this.c[1] }];\n    let val = 0;\n    let i = 0;\n    for (let j2 = 1; j2 < n; j2++) {\n      const target = sum * j2 / n;\n      while (val + quads[i].val < target) {\n        val += quads[i].val;\n        i++;\n      }\n      const a0 = quads[i].a0;\n      const a2 = quads[i].a2;\n      const u0 = approx_inv_myint(a0);\n      const u2 = approx_inv_myint(a2);\n      const a = a0 + (a2 - a0) * (target - val) / quads[i].val;\n      const u = approx_inv_myint(a);\n      const t = (u - u0) / (u2 - u0);\n      result.push(quads[i].quad.eval(t));\n    }\n    result.push({ x: this.c[6], y: this.c[7] });\n    return result;\n  }\n}\nconst BOX_SELECTOR = /&?(xywh=)?(pixel:|percent:|pct:)?([0-9]+(?:\\.[0-9]+)?),([0-9]+(?:\\.[0-9]+)?),([0-9]+(?:\\.[0-9]+)?),([0-9]+(?:\\.[0-9]+)?)/;\nconst TEMPORAL_SELECTOR = /&?(t=)(npt:)?([0-9]+(.[0-9]+)?)?(,([0-9]+(.[0-9]+)?))?/;\nconst RGBA_COLOR = /^rgba\\((\\d+),(\\d+),(\\d+),([0-9.]+)\\)$/;\nfunction parseSelector(source, { domParser, svgPreprocessor } = {}) {\n  var _a, _b;\n  if (Array.isArray(source)) {\n    return source.reduce(\n      (data, nextSource) => {\n        const { selector, selectors } = parseSelector(nextSource);\n        if (selector) {\n          if (!data.selector) {\n            data.selector = selector;\n          }\n          data.selectors.push(...selectors);\n        }\n        return data;\n      },\n      {\n        selector: null,\n        selectors: []\n      }\n    );\n  }\n  if (!source) {\n    return {\n      selector: null,\n      selectors: []\n    };\n  }\n  if (typeof source === \"string\") {\n    const [id, fragment] = source.split(\"#\");\n    if (!fragment) {\n      return {\n        selector: null,\n        selectors: []\n      };\n    }\n    return parseSelector({ type: \"FragmentSelector\", value: fragment });\n  }\n  if (source.type === \"PointSelector\" && (source.t || source.t === 0)) {\n    const selector = {\n      type: \"TemporalSelector\",\n      temporal: {\n        startTime: source.t\n      }\n    };\n    return {\n      selector,\n      selectors: [selector]\n    };\n  }\n  if (source.type === \"FragmentSelector\") {\n    const matchBoxSelector = BOX_SELECTOR.exec(source.value);\n    if (matchBoxSelector) {\n      const selector = {\n        type: \"BoxSelector\",\n        spatial: {\n          unit: matchBoxSelector[2] === \"percent:\" || matchBoxSelector[2] === \"pct:\" ? \"percent\" : \"pixel\",\n          x: parseFloat(matchBoxSelector[3]),\n          y: parseFloat(matchBoxSelector[4]),\n          width: parseFloat(matchBoxSelector[5]),\n          height: parseFloat(matchBoxSelector[6])\n        }\n      };\n      return {\n        selector,\n        selectors: [selector]\n      };\n    }\n    const matchTimeSelector = source.value.match(TEMPORAL_SELECTOR);\n    if (matchTimeSelector) {\n      const selector = {\n        type: \"TemporalSelector\",\n        temporal: {\n          startTime: matchTimeSelector[4] ? parseFloat(matchTimeSelector[4]) : 0,\n          endTime: matchTimeSelector[7] ? parseFloat(matchTimeSelector[7]) : void 0\n        }\n      };\n      return {\n        selector,\n        selectors: [selector]\n      };\n    }\n    return {\n      selector: null,\n      selectors: []\n    };\n  }\n  if (source.type === \"SvgSelector\" && \"value\" in source) {\n    if (!domParser) {\n      if (typeof window !== \"undefined\") {\n        domParser = new window.DOMParser();\n      } else {\n        console.warn(\n          \"No DOMParser available, cannot parse SVG selector, `points`, `spatial` and `style` will be unavailable and the SVG will not be normalized.\"\n        );\n      }\n    }\n    let points = [];\n    let rect;\n    let style;\n    let svg = (_a = svgPreprocessor == null ? void 0 : svgPreprocessor(source.value)) != null ? _a : source.value;\n    let svgShape;\n    if (domParser) {\n      const svgElement = domParser.parseFromString(source.value, \"image/svg+xml\").querySelector(\"svg\");\n      if (!svgElement) {\n        console.warn(`Illegal SVG selector: ${source.value}`);\n        return {\n          selector: null,\n          selectors: []\n        };\n      }\n      const selectorElem = getSelectorElement(svgElement);\n      if (selectorElem) {\n        points = selectorElem.points;\n        svgShape = selectorElem.shapeType;\n        rect = [\n          Math.min(...points.map((p2) => p2[0])),\n          Math.min(...points.map((p2) => p2[1])),\n          Math.max(...points.map((p2) => p2[0])),\n          Math.max(...points.map((p2) => p2[1]))\n        ];\n        ({ style, svg } = (_b = extractStyles(selectorElem.element)) != null ? _b : { svg });\n      }\n    }\n    const sel = {\n      type: \"SvgSelector\",\n      svg,\n      svgShape,\n      style,\n      points: points.length ? points : void 0,\n      spatial: rect ? { unit: \"pixel\", x: rect[0], y: rect[1], width: rect[2] - rect[0], height: rect[3] - rect[1] } : void 0\n    };\n    return {\n      selector: sel,\n      selectors: [sel]\n    };\n  }\n  return {\n    selector: null,\n    selectors: []\n  };\n}\nfunction getShapeTypeFromPath(svgPath) {\n  const cmdFrequencies = svgPath.map((seg) => seg[0]).reduce(\n    (acc, cmd) => {\n      acc[cmd] += 1;\n      return acc;\n    },\n    { C: 0, Q: 0, L: 0, M: 0 }\n  );\n  const cmdTypes = new Set(svgPath.map((seg) => seg[0]));\n  if (cmdFrequencies.C > 0 || cmdFrequencies.Q > 0) {\n    return \"path\";\n  }\n  if (cmdFrequencies.L > 0 && (cmdTypes.size === 1 || cmdTypes.size === 2 && cmdTypes.has(\"M\"))) {\n    if (cmdFrequencies.L === 4) {\n      return \"rect\";\n    }\n    const lastSeg = svgPath.slice(-1)[0];\n    if (svgPath[0][0] === \"M\" && lastSeg[0] === \"L\" && lastSeg[1] == svgPath[0][1] && lastSeg[2] === svgPath[0][2] || lastSeg[1] === 0 && lastSeg[2] === 0) {\n      return \"polygon\";\n    } else {\n      return \"polyline\";\n    }\n  }\n  return \"path\";\n}\nfunction getSelectorElement(svgElem) {\n  var _a, _b, _c, _d, _e2, _f, _g, _h, _i, _j, _k, _l, _m, _n, _o, _p, _q;\n  for (const element of Array.from(svgElem.children)) {\n    switch (element == null ? void 0 : element.tagName.toLowerCase()) {\n      case \"g\":\n        {\n          const res = getSelectorElement(element);\n          if (res) {\n            return res;\n          }\n        }\n        continue;\n      case \"path\": {\n        const p2 = element.getAttribute(\"d\");\n        if (!p2) {\n          continue;\n        }\n        const normalized = parseAndNormalizeSvgPath(p2);\n        return { element, points: pathToPoints(normalized), shapeType: getShapeTypeFromPath(normalized) };\n      }\n      case \"circle\": {\n        const cx = parseFloat((_a = element.getAttribute(\"cx\")) != null ? _a : \"0\");\n        const cy = parseFloat((_b = element.getAttribute(\"cy\")) != null ? _b : \"0\");\n        const r = parseFloat((_c = element.getAttribute(\"r\")) != null ? _c : \"0\");\n        if (!r) {\n          continue;\n        }\n        const points = [];\n        for (let angle = 0; angle <= 360; angle += 12) {\n          const rad = angle * Math.PI / 180;\n          points.push([cx + r * Math.cos(rad), cy + r * Math.sin(rad)]);\n        }\n        return { element, points, shapeType: \"circle\" };\n      }\n      case \"ellipse\": {\n        const cx = parseFloat((_d = element.getAttribute(\"cx\")) != null ? _d : \"0\");\n        const cy = parseFloat((_e2 = element.getAttribute(\"cy\")) != null ? _e2 : \"0\");\n        const rx = parseFloat((_f = element.getAttribute(\"rx\")) != null ? _f : \"0\");\n        const ry = parseFloat((_g = element.getAttribute(\"ry\")) != null ? _g : \"0\");\n        if (!rx && !ry) {\n          continue;\n        }\n        const points = [];\n        for (let angle = 0; angle <= 360; angle += 12) {\n          const t = Math.tan(angle / 360 * Math.PI);\n          const px = rx * (1 - t ** 2) / (1 + t ** 2);\n          const py = ry * 2 * t / (1 + t ** 2);\n          points.push([cx + px, cy + py]);\n        }\n        return { element, points, shapeType: \"ellipse\" };\n      }\n      case \"line\": {\n        const x0 = parseFloat((_h = element.getAttribute(\"x0\")) != null ? _h : \"0\");\n        const y0 = parseFloat((_i = element.getAttribute(\"y0\")) != null ? _i : \"0\");\n        const x1 = parseFloat((_j = element.getAttribute(\"x1\")) != null ? _j : \"0\");\n        const y1 = parseFloat((_k = element.getAttribute(\"y1\")) != null ? _k : \"0\");\n        if (x0 === x1 && y0 === y1) {\n          continue;\n        }\n        return {\n          element,\n          points: [\n            [x0, y0],\n            [x1, y1]\n          ],\n          shapeType: \"polyline\"\n        };\n      }\n      case \"polygon\":\n      case \"polyline\": {\n        const points = (_m = (_l = element.getAttribute(\"points\")) == null ? void 0 : _l.split(\" \").map((ps) => ps.split(\",\").map(parseFloat))) != null ? _m : [];\n        if (!points.length) {\n          continue;\n        }\n        let shapeType = \"polyline\";\n        if (element.tagName.toLowerCase() === \"polygon\") {\n          points.push(points[0]);\n          shapeType = \"polygon\";\n        }\n        return { element, points, shapeType };\n      }\n      case \"rect\": {\n        const x2 = parseFloat((_n = element.getAttribute(\"x\")) != null ? _n : \"0\");\n        const y2 = parseFloat((_o = element.getAttribute(\"y\")) != null ? _o : \"0\");\n        const width = parseFloat((_p = element.getAttribute(\"width\")) != null ? _p : \"0\");\n        const height = parseFloat((_q = element.getAttribute(\"height\")) != null ? _q : \"0\");\n        if (!width || !height) {\n          continue;\n        }\n        return {\n          element,\n          points: [\n            [x2, y2],\n            [x2 + width, y2],\n            [x2 + width, y2 + height],\n            [x2, y2 + height],\n            [x2, y2]\n          ],\n          shapeType: \"rect\"\n        };\n      }\n      default:\n        continue;\n    }\n  }\n  return null;\n}\nfunction pathToPoints(normalizedPath) {\n  var _a;\n  const out = [];\n  for (let i = 0; i < normalizedPath.length; i++) {\n    const startPoint = (_a = out[out.length - 1]) != null ? _a : [0, 0];\n    const seg = normalizedPath[i];\n    switch (seg[0]) {\n      case \"M\":\n      case \"L\":\n        out.push([seg[1], seg[2]]);\n        continue;\n      case \"C\":\n        out.push(\n          ...flattenCubicBezier(\n            { x: startPoint[0], y: startPoint[1] },\n            { x: seg[1], y: seg[2] },\n            { x: seg[3], y: seg[4] },\n            { x: seg[5], y: seg[6] }\n          ).map((p2) => [p2.x, p2.y]).slice(1)\n        );\n        continue;\n      case \"Q\":\n        out.push(\n          ...flattenQuadraticBezier(\n            { x: startPoint[0], y: startPoint[1] },\n            { x: seg[1], y: seg[2] },\n            { x: seg[3], y: seg[4] }\n          ).map((p2) => [p2.x, p2.y]).slice(1)\n        );\n        continue;\n    }\n  }\n  return out;\n}\nfunction extractStyles(selectorElement) {\n  const style = {};\n  if (selectorElement.hasAttribute(\"fill\")) {\n    style.fill = selectorElement.getAttribute(\"fill\");\n    selectorElement.removeAttribute(\"fill\");\n  } else if (selectorElement.style.fill) {\n    style.fill = selectorElement.style.fill;\n  }\n  if (style.fill) {\n    const rgbaMatch = RGBA_COLOR.exec(style.fill);\n    if (rgbaMatch) {\n      style.fillOpacity = parseFloat(rgbaMatch[4]);\n      style.fill = `rgb(${rgbaMatch[1]}, ${rgbaMatch[2]}, ${rgbaMatch[3]})`;\n    }\n  }\n  if (selectorElement.hasAttribute(\"fill-opacity\")) {\n    style.fillOpacity = parseFloat(selectorElement.getAttribute(\"fill-opacity\"));\n    selectorElement.removeAttribute(\"fill-opacity\");\n  } else if (selectorElement.style.fillOpacity) {\n    style.fillOpacity = parseFloat(selectorElement.style.fillOpacity);\n  }\n  if (selectorElement.hasAttribute(\"stroke\")) {\n    style.stroke = selectorElement.getAttribute(\"stroke\");\n    selectorElement.removeAttribute(\"stroke\");\n  } else if (selectorElement.style.stroke) {\n    style.stroke = selectorElement.style.stroke;\n  }\n  if (style.stroke) {\n    const rgbaMatch = RGBA_COLOR.exec(style.stroke);\n    if (rgbaMatch) {\n      style.strokeOpacity = parseFloat(rgbaMatch[4]);\n      style.stroke = `rgb(${rgbaMatch[1]}, ${rgbaMatch[2]}, ${rgbaMatch[3]})`;\n    }\n  }\n  if (selectorElement.hasAttribute(\"stroke-opacity\")) {\n    style.strokeOpacity = parseFloat(selectorElement.getAttribute(\"stroke-opacity\"));\n    selectorElement.removeAttribute(\"stroke-opacity\");\n  } else if (selectorElement.style.strokeOpacity) {\n    style.strokeOpacity = parseFloat(selectorElement.style.strokeOpacity);\n  }\n  if (selectorElement.hasAttribute(\"stroke-width\")) {\n    style.strokeWidth = selectorElement.getAttribute(\"stroke-width\");\n    selectorElement.removeAttribute(\"stroke-width\");\n  } else if (selectorElement.style.strokeWidth) {\n    style.strokeWidth = selectorElement.style.strokeWidth;\n  }\n  if (selectorElement.hasAttribute(\"stroke-dasharray\")) {\n    style.strokeDasharray = selectorElement.getAttribute(\"stroke-dasharray\");\n    selectorElement.removeAttribute(\"stroke-dasharray\");\n  } else if (selectorElement.style.strokeDasharray) {\n    style.strokeDasharray = selectorElement.style.strokeDasharray;\n  }\n  let rootElem = selectorElement;\n  while (rootElem.tagName.toLowerCase() !== \"svg\") {\n    rootElem = rootElem.parentElement;\n    if (rootElem === null) {\n      throw new Error(\"Could not find root SVG element\");\n    }\n  }\n  return { svg: rootElem.outerHTML, style: Object.keys(style).length > 0 ? style : void 0 };\n}\nfunction expandTarget(target, options = {}) {\n  if (Array.isArray(target)) {\n    return expandTarget(target[0]);\n  }\n  if (typeof target === \"string\") {\n    const [id, fragment] = target.split(\"#\");\n    if (!fragment) {\n      return {\n        type: \"SpecificResource\",\n        source: { id, type: options.typeMap && options.typeMap[id] || \"Unknown\" },\n        selector: null,\n        selectors: []\n      };\n    }\n    return expandTarget({\n      type: \"SpecificResource\",\n      source: { id, type: \"Unknown\" },\n      selector: {\n        type: \"FragmentSelector\",\n        value: fragment\n      }\n    });\n  }\n  if (target.type === \"Choice\" || target.type === \"List\" || target.type === \"Composite\" || target.type === \"Independents\") {\n    return expandTarget(target.items[0]);\n  }\n  if (target.type === \"SpecificResource\") {\n    if (target.source.type === \"Canvas\" && target.source.partOf && typeof target.source.partOf === \"string\") {\n      target.source.partOf = [\n        {\n          id: target.source.partOf,\n          type: \"Manifest\"\n        }\n      ];\n    }\n    const { selector, selectors } = target.selector ? parseSelector(target.selector, options) : { selector: null, selectors: [] };\n    return {\n      type: \"SpecificResource\",\n      source: target.source,\n      selector,\n      selectors\n    };\n  }\n  if (target.id) {\n    if (target.type === \"Canvas\" && target.partOf && typeof target.partOf === \"string\") {\n      target.partOf = [\n        {\n          id: target.partOf,\n          type: \"Manifest\"\n        }\n      ];\n    }\n    const [id, fragment] = target.id.split(\"#\");\n    if (!fragment) {\n      return {\n        type: \"SpecificResource\",\n        source: {\n          ...target,\n          id\n        },\n        selector: null,\n        selectors: []\n      };\n    }\n    return expandTarget({\n      type: \"SpecificResource\",\n      source: {\n        ...target,\n        id\n      },\n      selector: {\n        type: \"FragmentSelector\",\n        value: fragment\n      }\n    });\n  }\n  return {\n    type: \"SpecificResource\",\n    source: target,\n    selector: null,\n    selectors: []\n  };\n}\nfunction validateContentState(annotation, strict = false) {\n  if (typeof annotation === \"string\") {\n    if (annotation.startsWith(\"{\")) {\n      try {\n        const parsed = JSON.parse(annotation);\n        return validateContentState(parsed);\n      } catch (err) {\n        return [false, { reason: \"Invalid JSON\" }];\n      }\n    }\n    return [true];\n  }\n  if (Array.isArray(annotation)) {\n    for (const anno of annotation) {\n      const [valid, reason] = validateContentState(anno);\n      if (!valid && reason) {\n        return [valid, reason];\n      }\n    }\n    return [true];\n  }\n  if (annotation.type === \"Annotation\") {\n    return [true];\n  }\n  if (strict && annotation.type === \"Canvas\" && !annotation.partOf) {\n    return [false, { reason: \"Canvas without partOf cannot be loaded\" }];\n  }\n  return [true];\n}\nfunction serialiseContentState(annotation) {\n  return encodeContentState(typeof annotation === \"string\" ? annotation : JSON.stringify(annotation));\n}\nfunction parseContentState(state, asyncOrFetcher) {\n  state = state.trim();\n  if (state[0] === \"{\") {\n    return asyncOrFetcher ? Promise.resolve(JSON.parse(state)) : JSON.parse(state);\n  }\n  if (state.startsWith(\"http\")) {\n    if (!asyncOrFetcher) {\n      throw new Error(\"Cannot fetch remote fetch with async=false in parseContentState\");\n    }\n    return fetch(state).then((r) => r.json());\n  }\n  return parseContentState(decodeContentState(state), asyncOrFetcher);\n}\nfunction encodeContentState(state) {\n  const uriEncoded = encodeURIComponent(state);\n  const base64 = typeof btoa === \"undefined\" ? Buffer.from(uriEncoded, \"utf-8\").toString(\"base64\") : btoa(uriEncoded);\n  const base64url = base64.replace(/\\+/g, \"-\").replace(/\\//g, \"_\");\n  return base64url.replace(/=/g, \"\");\n}\nfunction decodeContentState(encodedContentState) {\n  const base64url = restorePadding(encodedContentState);\n  const base64 = base64url.replace(/-/g, \"+\").replace(/_/g, \"/\");\n  const base64Decoded = typeof atob === \"undefined\" ? Buffer.from(base64, \"base64\").toString(\"utf-8\") : atob(base64);\n  return decodeURIComponent(base64Decoded).trim();\n}\nfunction restorePadding(s) {\n  const pad = s.length % 4;\n  if (pad === 1) {\n    throw new Error(\"InvalidLengthError: Input base64url string is the wrong length to determine padding\");\n  }\n  return s + (pad ? \"====\".slice(0, 4 - pad) : \"\");\n}\nfunction normaliseContentState(state) {\n  if (!state) {\n    throw new Error(\"Content state is empty\");\n  }\n  if (!Array.isArray(state)) {\n    state = [state];\n  }\n  let annoId = \"vault://virtual-annotation/\" + new Date().getTime();\n  const targets = [];\n  for (const source of state) {\n    if (typeof source === \"string\") {\n      throw new Error(\"Content state is a [String] type and cannot be inferred\");\n    }\n    if (source.type === \"Annotation\") {\n      annoId = source.id;\n      if (Array.isArray(source.motivation)) {\n        for (const singleMotivation of source.motivation) {\n        }\n      }\n      if (Array.isArray(source.target)) {\n        for (const target2 of source.target) {\n          const expanded = expandTarget(target2);\n          targets.push(expanded);\n        }\n      } else {\n        const expanded = expandTarget(source.target);\n        targets.push(expanded);\n      }\n      continue;\n    }\n    const target = expandTarget(source);\n    targets.push(target);\n  }\n  return {\n    id: annoId,\n    type: \"Annotation\",\n    motivation: [\"contentState\", ...state.motivation || []],\n    target: targets,\n    extensions: {}\n  };\n}\nfunction parseSpecificResource(resource) {\n  if (resource.type === \"SpecificResource\") {\n    return [resource.source, { selector: resource.selector }];\n  }\n  return [resource, { selector: null }];\n}\nfunction createPaintingAnnotationsHelper(vault = compatVault) {\n  function getAllPaintingAnnotations(canvasOrId) {\n    const canvas = canvasOrId ? typeof canvasOrId === \"string\" ? vault.get(canvasOrId) : canvasOrId : null;\n    if (!canvas) {\n      return [];\n    }\n    const annotationPages = vault.get(canvas.items);\n    const flatAnnotations = [];\n    for (const page of annotationPages) {\n      flatAnnotations.push(...vault.get(page.items));\n    }\n    return flatAnnotations;\n  }\n  function getPaintables(paintingAnnotationsOrCanvas, enabledChoices = []) {\n    const paintingAnnotations = Array.isArray(paintingAnnotationsOrCanvas) ? paintingAnnotationsOrCanvas : getAllPaintingAnnotations(paintingAnnotationsOrCanvas);\n    const types = [];\n    let choice = null;\n    const items = [];\n    for (const annotation of paintingAnnotations) {\n      if (annotation.type !== \"Annotation\") {\n        throw new Error(`getPaintables() accept either a canvas or list of annotations`);\n      }\n      const unknownBodies = vault.get(annotation.body);\n      const bodies = Array.isArray(unknownBodies) ? unknownBodies : [unknownBodies];\n      for (const unknownBody of bodies) {\n        const [body, { selector }] = parseSpecificResource(unknownBody);\n        const type = (body.type || \"unknown\").toLowerCase();\n        if (type === \"choice\") {\n          const nestedBodies = vault.get(body.items);\n          const selected = enabledChoices.length ? enabledChoices.map((cid) => nestedBodies.find((b2) => b2.id === cid)).filter(Boolean) : [nestedBodies[0]];\n          if (selected.length === 0) {\n            selected.push(nestedBodies[0]);\n          }\n          choice = {\n            type: \"single-choice\",\n            items: nestedBodies.map((b2) => ({\n              id: b2.id,\n              label: b2.label,\n              selected: selected.indexOf(b2) !== -1\n            })),\n            label: unknownBody.label\n          };\n          bodies.push(...selected);\n          continue;\n        }\n        if (types.indexOf(type) === -1) {\n          types.push(type);\n        }\n        items.push({\n          type,\n          resource: body,\n          target: annotation.target,\n          selector\n        });\n      }\n    }\n    return {\n      types,\n      items,\n      choice\n    };\n  }\n  function extractChoices(paintingAnnotationsOrCanvas) {\n    const { choice } = getPaintables(paintingAnnotationsOrCanvas);\n    return choice;\n  }\n  return {\n    getAllPaintingAnnotations,\n    getPaintables,\n    extractChoices\n  };\n}\nfunction defineProperty(name, prototype, vault) {\n  prototype[DEFINED] = prototype[DEFINED] || [];\n  prototype[DEFINED].push(name);\n  Object.defineProperty(prototype, name, {\n    get() {\n      if (typeof prototype[REFS][name] === \"undefined\") {\n        return void 0;\n      }\n      const ref = prototype[REFS][name];\n      if (!ref) {\n        return ref;\n      }\n      return wrapObject(vault.get(prototype[REFS][name]), vault);\n    },\n    set(items) {\n      const existing = prototype[REFS][name];\n      if (existing !== items) {\n        this[REFS][name] = items;\n      }\n    }\n  });\n}\nconst REFS = Symbol.for(\"_refs_\");\nconst REACTIVE = Symbol.for(\"_reactive_\");\nconst DEFINED = Symbol.for(\"_defined_\");\nfunction createPrototype(vault, reactive = false) {\n  const prototype = {\n    id: null,\n    [DEFINED]: [],\n    [REFS]: {},\n    [REACTIVE]: null,\n    is(refOrObject) {\n      if (typeof refOrObject === \"string\") {\n        return this.id === refOrObject;\n      }\n      if (refOrObject.id) {\n        return refOrObject.id === this.id;\n      }\n      return false;\n    },\n    reactive() {\n      if (this[REACTIVE]) {\n        return;\n      }\n      this[REACTIVE] = this.subscribe(() => this.refresh(), true);\n      return () => {\n        this.unreactive();\n      };\n    },\n    refresh() {\n      if (this.id) {\n        const fresh = this.unwrap();\n        for (const key of Object.keys(fresh || {})) {\n          if (this[DEFINED].includes(key)) {\n            this[REFS][key] = fresh[key];\n          } else {\n            this[key] = fresh[key];\n          }\n        }\n      }\n    },\n    unreactive() {\n      if (this[REACTIVE]) {\n        this[REACTIVE]();\n        this[REACTIVE] = null;\n      }\n    },\n    unwrap() {\n      if (!this.id) {\n        throw new Error(\"Invalid object\");\n      }\n      return vault.get(this.id);\n    },\n    toPresentation3() {\n      return vault.toPresentation3(this.unwrap());\n    },\n    toPresentation2() {\n      return vault.toPresentation2(this.unwrap());\n    },\n    toJSON() {\n      const that = this;\n      return {\n        ...that,\n        items: that.items,\n        annotations: that.annotations,\n        structures: that.structures,\n        seeAlso: that.seeAlso,\n        service: that.service,\n        services: that.services,\n        rendering: that.rendering,\n        partOf: that.partOf,\n        start: that.start,\n        supplementary: that.supplementary,\n        homepage: that.homepage,\n        thumbnail: that.thumbnail,\n        placeholderCanvas: that.placeholderCanvas,\n        accompanyingCanvas: that.accompanyingCanvas,\n        provider: that.provider\n      };\n    },\n    subscribe(subscription, skipInitial = true) {\n      return vault.subscribe(\n        () => {\n          return this.id ? vault.get(this.id) : null;\n        },\n        subscription,\n        skipInitial\n      );\n    }\n  };\n  defineProperty(\"items\", prototype, vault);\n  defineProperty(\"annotations\", prototype, vault);\n  defineProperty(\"structures\", prototype, vault);\n  defineProperty(\"seeAlso\", prototype, vault);\n  defineProperty(\"service\", prototype, vault);\n  defineProperty(\"services\", prototype, vault);\n  defineProperty(\"rendering\", prototype, vault);\n  defineProperty(\"partOf\", prototype, vault);\n  defineProperty(\"start\", prototype, vault);\n  defineProperty(\"supplementary\", prototype, vault);\n  defineProperty(\"homepage\", prototype, vault);\n  defineProperty(\"thumbnail\", prototype, vault);\n  defineProperty(\"placeholderCanvas\", prototype, vault);\n  defineProperty(\"accompanyingCanvas\", prototype, vault);\n  defineProperty(\"provider\", prototype, vault);\n  defineProperty(\"body\", prototype, vault);\n  defineProperty(\"logo\", prototype, vault);\n  return prototype;\n}\nfunction unwrapObject(object) {\n  if (Array.isArray(object)) {\n    return object.map((o) => unwrapObject(o));\n  }\n  if (!object || !object.type) {\n    return object;\n  }\n  return { id: object.id, type: object.type };\n}\nfunction wrapObject(object, vault, reactive = false) {\n  if (Array.isArray(object)) {\n    return object.map((o) => wrapObject(o, vault, reactive));\n  }\n  if (!object || !object.type || !object.id) {\n    return object;\n  }\n  const prototype = createPrototype(vault, reactive);\n  const newObject = Object.create(prototype);\n  const wrapped = Object.assign(newObject, object);\n  if (reactive) {\n    wrapped.reactive();\n  }\n  return wrapped;\n}\nfunction createObjectsHelper(vault) {\n  return {\n    get(id, reactive = false) {\n      return wrapObject(vault.get(id), vault, reactive);\n    },\n    async load(id, json) {\n      return wrapObject(await vault.load(id, json), vault);\n    },\n    async loadManifest(id, json) {\n      return wrapObject(await vault.loadManifest(id, json), vault);\n    },\n    async loadCollection(id, json) {\n      return wrapObject(await vault.loadCollection(id, json), vault);\n    },\n    wrapObject(objectType) {\n      return wrapObject(vault.get(objectType, { skipSelfReturn: false }), vault);\n    },\n    isWrapped(object) {\n      return !!object[DEFINED];\n    }\n  };\n}\nfunction createRangeHelper(vault = compatVault) {\n  return {\n    findFirstCanvasFromRange: (range) => findFirstCanvasFromRange(vault, range),\n    findAllCanvasesInRange: (range) => findAllCanvasesInRange(vault, range),\n    findManifestSelectedRange: (manifest, canvasId) => findManifestSelectedRange(vault, manifest, canvasId),\n    findSelectedRange: (range, canvasId) => findSelectedRange(vault, range, canvasId)\n  };\n}\nfunction findFirstCanvasFromRange(vault, range) {\n  for (const inner of range.items) {\n    if (inner.type === \"Canvas\") {\n      return inner;\n    }\n    if (inner.type === \"Range\") {\n      const found = findFirstCanvasFromRange(vault, vault.get(inner));\n      if (found) {\n        return found;\n      }\n    }\n  }\n  return null;\n}\nfunction findAllCanvasesInRange(vault, range) {\n  const found = [];\n  for (const inner of range.items) {\n    if (inner.type === \"Canvas\") {\n      if (inner.id.indexOf(\"#\") !== -1) {\n        found.push({ id: inner.id.split(\"#\")[0], type: \"Canvas\" });\n      } else {\n        found.push(inner);\n      }\n    }\n    if (inner.type === \"Range\") {\n      found.push(...findAllCanvasesInRange(vault, vault.get(inner)));\n    }\n    if (inner.type === \"SpecificResource\") {\n      const sourceId = typeof inner.source === \"string\" ? inner.source : inner.source.id;\n      found.push({ id: sourceId, type: \"Canvas\" });\n    }\n  }\n  return found;\n}\nfunction findManifestSelectedRange(vault, manifest, canvasId) {\n  for (const range of manifest.structures) {\n    const found = findSelectedRange(vault, vault.get(range), canvasId);\n    if (found) {\n      return found;\n    }\n  }\n  return null;\n}\nfunction findSelectedRange(vault, range, canvasId) {\n  var _a;\n  for (const inner of range.items) {\n    const parsedId = (_a = inner.id) == null ? void 0 : _a.split(\"#\")[0];\n    if (inner.type === \"SpecificResource\" && inner.source === canvasId) {\n      return range;\n    }\n    if (inner.type === \"Canvas\" && canvasId === parsedId) {\n      return range;\n    }\n    if (inner.type === \"Range\") {\n      const found = findSelectedRange(vault, vault.get(inner), canvasId);\n      if (found) {\n        return found;\n      }\n    }\n  }\n  return null;\n}\nfunction createSequenceHelper(vault = compatVault) {\n  return {\n    getVisibleCanvasesFromCanvasId: (manifestOrRange, canvasId, preventPaged = false) => getVisibleCanvasesFromCanvasId(vault, manifestOrRange, canvasId, preventPaged),\n    getManifestSequence: (manifestOrRange, options = {}) => getManifestSequence(vault, manifestOrRange, options)\n  };\n}\nfunction getVisibleCanvasesFromCanvasId(vault = compatVault, manifestOrRange, canvasId, preventPaged = false) {\n  const behavior = manifestOrRange.behavior || [];\n  const fullCanvas = canvasId ? vault.get(canvasId) : null;\n  if (!fullCanvas) {\n    return [];\n  }\n  const canvasBehavior = fullCanvas.behavior || [];\n  const isPaged = preventPaged ? false : behavior.includes(\"paged\");\n  const isContinuous = isPaged ? false : behavior.includes(\"continuous\");\n  const isIndividuals = isPaged || isContinuous ? false : behavior.includes(\"individuals\");\n  const isCanvasFacingPages = canvasBehavior.includes(\"facing-pages\");\n  const isCanvasNonPaged = canvasBehavior.includes(\"non-paged\");\n  if (isCanvasFacingPages || isCanvasNonPaged || isIndividuals || preventPaged) {\n    return [{ id: fullCanvas.id, type: \"Canvas\" }];\n  }\n  const [manifestItems, ordering] = getManifestSequence(vault, manifestOrRange);\n  if (isContinuous) {\n    return manifestItems;\n  }\n  const canvasIndex = manifestItems.findIndex((r) => r.id === canvasId);\n  if (canvasIndex === -1) {\n    return [];\n  }\n  for (const indexes of ordering) {\n    if (indexes.includes(canvasIndex)) {\n      return indexes.map((index) => manifestItems[index]);\n    }\n  }\n  return [{ id: fullCanvas.id, type: \"Canvas\" }];\n}\nfunction getManifestSequence(vault = compatVault, manifestOrRange, { disablePaging, skipNonPaged } = {}) {\n  const behavior = manifestOrRange.behavior || [];\n  const isPaged = behavior.includes(\"paged\");\n  const isContinuous = isPaged ? false : behavior.includes(\"continuous\");\n  const isIndividuals = isPaged || isContinuous ? false : behavior.includes(\"individuals\");\n  const manifestItems = manifestOrRange.type === \"Manifest\" ? manifestOrRange.items : findAllCanvasesInRange(vault, manifestOrRange);\n  if (isContinuous) {\n    return [manifestItems, [manifestItems.map((_2, index) => index)]];\n  }\n  if (isIndividuals || !isPaged || disablePaging) {\n    return [manifestItems, manifestItems.map((_2, index) => [index])];\n  }\n  const ordering = [];\n  let currentOrdering = [];\n  const flush = () => {\n    if (currentOrdering.length) {\n      ordering.push([...currentOrdering]);\n      currentOrdering = [];\n    }\n  };\n  let offset = 0;\n  let flushNextPaged = false;\n  for (let i = 0; i < manifestItems.length; i++) {\n    const canvas = vault.get(manifestItems[i]);\n    const canvasBehavior = canvas.behavior || [];\n    if (canvasBehavior.includes(\"non-paged\")) {\n      if (i === offset) {\n        offset++;\n      }\n      if (!skipNonPaged) {\n        flush();\n        ordering.push([i]);\n        flush();\n      }\n      continue;\n    }\n    if (i === offset || canvasBehavior.includes(\"facing-pages\")) {\n      if (currentOrdering.length) {\n        flushNextPaged = true;\n      }\n      flush();\n      ordering.push([i]);\n      flush();\n      continue;\n    }\n    currentOrdering.push(i);\n    if (flushNextPaged) {\n      flush();\n      flushNextPaged = false;\n      continue;\n    }\n    if (currentOrdering.length > 1) {\n      flush();\n    }\n  }\n  if (currentOrdering.length) {\n    flush();\n  }\n  return [manifestItems, ordering];\n}\nexport { buildLocaleString, createEventsHelper, createObjectsHelper, createPaintingAnnotationsHelper, createRangeHelper, createSequenceHelper, createStylesHelper, createThumbnailHelper, decodeContentState, encodeContentState, expandTarget, findAllCanvasesInRange, findFirstCanvasFromRange, findManifestSelectedRange, findSelectedRange, getClosestLanguage, getManifestSequence, getValue, getVisibleCanvasesFromCanvasId, normaliseContentState, parseContentState, parseSelector, parseSpecificResource, serialiseContentState, unwrapObject, validateContentState, wrapObject };\n//# sourceMappingURL=index.mjs.map\n","var commonjsGlobal = typeof globalThis !== \"undefined\" ? globalThis : typeof window !== \"undefined\" ? window : typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : {};\nvar index_umd = { exports: {} };\n(function(module, exports) {\n  var __defProp = Object.defineProperty, __defNormalProp = (e, t, i) => t in e ? __defProp(e, t, { enumerable: true, configurable: true, writable: true, value: i }) : e[t] = i, __publicField = (e, t, i) => (__defNormalProp(e, \"symbol\" != typeof t ? t + \"\" : t, i), i);\n  !function(e, t) {\n    t(exports);\n  }(commonjsGlobal, function(e) {\n    const t = \"http://library.stanford.edu/iiif/image-api/compliance.html#level1\", i = \"http://library.stanford.edu/iiif/image-api/compliance.html#level2\", r = \"http://library.stanford.edu/iiif/image-api/conformance.html#level1\", n = \"http://library.stanford.edu/iiif/image-api/conformance.html#level2\", s = \"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1\", a = \"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2\", o = \"http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1\", c = \"http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2\", l = \"http://iiif.io/api/image/1/level1.json\", p = \"http://iiif.io/api/image/1/profiles/level1.json\", h = \"http://iiif.io/api/image/1/level2.json\", u = \"http://iiif.io/api/image/1/profiles/level2.json\", v = \"http://iiif.io/api/image/2/level1.json\", f = \"http://iiif.io/api/image/2/profiles/level1.json\", m = \"http://iiif.io/api/image/2/level2.json\", y = \"http://iiif.io/api/image/2/profiles/level2.json\", g = \"level1\", d = \"level2\", A = \"http://iiif.io/api/image/2/level1\", b = \"http://iiif.io/api/image/2/level2\", C = [A, b, t, i, r, n, s, a, o, c, l, p, h, u, v, f, m, y, g, d], x = [\"http://iiif.io/api/image/2/level0\", A, b, \"http://library.stanford.edu/iiif/image-api/compliance.html#level0\", t, i, \"http://library.stanford.edu/iiif/image-api/conformance.html#level0\", r, n, \"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0\", s, a, \"http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0\", o, c, \"http://iiif.io/api/image/1/level0.json\", \"http://iiif.io/api/image/1/profiles/level0.json\", l, p, h, u, \"http://iiif.io/api/image/2/level0.json\", \"http://iiif.io/api/image/2/profiles/level0.json\", v, f, m, y, \"level0\", g, d], w = [\"sc:Collection\", \"sc:Manifest\", \"sc:Canvas\", \"sc:AnnotationList\", \"oa:Annotation\", \"sc:Range\", \"sc:Layer\", \"sc:Sequence\", \"oa:Choice\", \"Service\", \"ContentResource\"];\n    class L {\n      constructor(e2, t2 = {}) {\n        __publicField(this, \"traversals\"), __publicField(this, \"options\"), this.traversals = { collection: [], manifest: [], canvas: [], annotationList: [], sequence: [], annotation: [], contentResource: [], choice: [], range: [], service: [], layer: [], ...e2 }, this.options = { convertPropsToArray: true, mergeMemberProperties: true, allowUndefinedReturn: false, ...t2 };\n      }\n      static all(e2) {\n        return new L({ collection: [e2], manifest: [e2], canvas: [e2], annotationList: [e2], sequence: [e2], annotation: [e2], contentResource: [e2], choice: [e2], range: [e2], service: [e2], layer: [e2] });\n      }\n      traverseCollection(e2) {\n        return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCollectionItems(e2))), this.traversals.collection);\n      }\n      traverseCollectionItems(e2) {\n        if (this.options.mergeMemberProperties) {\n          const t2 = [...(e2.manifests || []).map((e3) => \"string\" == typeof e3 ? { \"@id\": e3, \"@type\": \"sc:Manifest\" } : e3), ...(e2.collections || []).map((e3) => \"string\" == typeof e3 ? { \"@id\": e3, \"@type\": \"sc:Collection\" } : e3), ...e2.members || []];\n          delete e2.collections, delete e2.manifests, e2.members = t2;\n        }\n        return e2.manifests && (e2.manifests = e2.manifests.map((e3) => this.traverseManifest(\"string\" == typeof e3 ? { \"@id\": e3, \"@type\": \"sc:Manifest\" } : e3))), e2.collections && (e2.collections = e2.collections.map((e3) => this.traverseCollection(\"string\" == typeof e3 ? { \"@id\": e3, \"@type\": \"sc:Collection\" } : e3))), e2.members && (e2.members = e2.members.map((e3) => \"string\" == typeof e3 ? e3 : this.traverseUnknown(e3))), e2;\n      }\n      traverseManifest(e2) {\n        return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(e2))), this.traversals.manifest);\n      }\n      traverseManifestItems(e2) {\n        return e2.sequences && (e2.sequences = e2.sequences.map((e3) => this.traverseSequence(e3))), e2.structures && (e2.structures = e2.structures.map((e3) => this.traverseRange(e3))), e2;\n      }\n      traverseSequence(e2) {\n        return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseSequenceItems(e2))), this.traversals.sequence);\n      }\n      traverseSequenceItems(e2) {\n        return e2.canvases && (e2.canvases = e2.canvases.map((e3) => this.traverseCanvas(e3))), e2;\n      }\n      traverseCanvas(e2) {\n        return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(e2))), this.traversals.canvas);\n      }\n      traverseCanvasItems(e2) {\n        return e2.images && (e2.images = e2.images.map((e3) => this.traverseAnnotation(e3))), e2.otherContent && (e2.otherContent = e2.otherContent.map((e3) => this.traverseAnnotationList(e3))), e2;\n      }\n      traverseRange(e2) {\n        return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseRangeItems(e2))), this.traversals.range);\n      }\n      traverseRangeItems(e2) {\n        if (this.options.mergeMemberProperties) {\n          const t2 = [...(e2.ranges || []).map((e3) => \"string\" == typeof e3 ? { \"@id\": e3, \"@type\": \"sc:Range\" } : e3), ...(e2.canvases || []).map((e3) => \"string\" == typeof e3 ? { \"@id\": e3, \"@type\": \"sc:Canvas\" } : e3), ...e2.members || []];\n          delete e2.ranges, delete e2.canvases, e2.members = t2.length ? t2.map((e3) => this.traverseUnknown(e3)) : void 0;\n        }\n        return e2;\n      }\n      traverseAnnotationList(e2) {\n        const t2 = \"string\" == typeof e2 ? { \"@id\": e2, \"@type\": \"sc:AnnotationList\" } : e2;\n        return this.traverseType(this.traverseDescriptive(this.traverseAnnotationListItems(t2)), this.traversals.annotationList);\n      }\n      traverseAnnotationListItems(e2) {\n        return e2.resources && (e2.resources = e2.resources.map((e3) => this.traverseAnnotation(e3))), e2;\n      }\n      traverseAnnotation(e2) {\n        return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationItems(e2))), this.traversals.annotation);\n      }\n      traverseAnnotationItems(e2) {\n        return e2.resource && (Array.isArray(e2.resource) ? e2.resource = e2.resource.map((e3) => this.traverseContentResource(e3)) : e2.resource = this.traverseContentResource(e2.resource)), e2.on, e2;\n      }\n      traverseLayer(e2) {\n        return this.traverseType(this.traverseLinking(this.traverseLayerItems(e2)), this.traversals.layer);\n      }\n      traverseLayerItems(e2) {\n        return e2.otherContent && (e2.otherContent = e2.otherContent.map((e3) => this.traverseAnnotationList(e3))), e2;\n      }\n      traverseChoice(e2) {\n        return this.traverseType(this.traverseChoiceItems(e2), this.traversals.choice);\n      }\n      traverseChoiceItems(e2) {\n        return e2.default && \"rdf:nil\" !== e2.default && (e2.default = this.traverseContentResource(e2.default)), e2.item && \"rdf:nil\" !== e2.item && (e2.item = e2.item.map((e3) => this.traverseContentResource(e3))), e2;\n      }\n      traverseService(e2) {\n        return this.traverseType(this.traverseLinking(e2), this.traversals.service);\n      }\n      traverseContentResource(e2) {\n        return \"oa:Choice\" === e2[\"@type\"] ? this.traverseChoice(e2) : this.traverseType(this.traverseDescriptive(this.traverseLinking(e2)), this.traversals.contentResource);\n      }\n      traverseUnknown(e2) {\n        if (!e2[\"@type\"] || \"string\" == typeof e2)\n          return e2;\n        switch (function(e3) {\n          if (null == e3)\n            throw new Error(\"Null or undefined is not a valid entity.\");\n          if (Array.isArray(e3))\n            throw new Error(\"Array is not a valid entity\");\n          if (\"object\" != typeof e3)\n            throw new Error(typeof e3 + \" is not a valid entity\");\n          if (\"string\" == typeof e3[\"@type\"]) {\n            const t2 = w.indexOf(e3[\"@type\"]);\n            if (-1 !== t2)\n              return w[t2];\n          }\n          if (e3.profile)\n            return \"Service\";\n          if (e3.format)\n            return \"ContentResource\";\n          if (e3[\"@type\"])\n            return \"ContentResource\";\n          throw new Error(\"Resource type is not known\");\n        }(e2)) {\n          case \"sc:Collection\":\n            return this.traverseCollection(e2);\n          case \"sc:Manifest\":\n            return this.traverseManifest(e2);\n          case \"sc:Canvas\":\n            return this.traverseCanvas(e2);\n          case \"sc:Sequence\":\n            return this.traverseSequence(e2);\n          case \"sc:Range\":\n            return this.traverseRange(e2);\n          case \"oa:Annotation\":\n            return this.traverseAnnotation(e2);\n          case \"sc:AnnotationList\":\n            return this.traverseAnnotationList(e2);\n          case \"sc:Layer\":\n            return this.traverseLayer(e2);\n          case \"Service\":\n            return this.traverseService(e2);\n          case \"oa:Choice\":\n            return this.traverseChoice(e2);\n          case \"ContentResource\":\n            return this.traverseContentResource(e2);\n        }\n        return e2.profile ? this.traverseService(e2) : e2;\n      }\n      traverseImageResource(e2) {\n        const t2 = Array.isArray(e2), i2 = Array.isArray(e2) ? e2 : [e2], r2 = [];\n        for (const n2 of i2)\n          \"string\" == typeof n2 ? r2.push(this.traverseContentResource({ \"@id\": n2, \"@type\": \"dctypes:Image\" })) : r2.push(this.traverseContentResource(n2));\n        return t2 || this.options.convertPropsToArray ? r2 : r2[0];\n      }\n      traverseDescriptive(e2) {\n        return e2.thumbnail && (e2.thumbnail = this.traverseImageResource(e2.thumbnail)), e2.logo && (e2.logo = this.traverseImageResource(e2.logo)), e2;\n      }\n      traverseOneOrMoreServices(e2) {\n        const t2 = Array.isArray(e2), i2 = Array.isArray(e2) ? e2 : [e2], r2 = [];\n        for (const n2 of i2)\n          r2.push(this.traverseService(n2));\n        return t2 || this.options.convertPropsToArray ? r2 : r2[0];\n      }\n      traverseLinking(e2) {\n        return e2.related && (e2.related = this.traverseOneOrManyType(e2.related, this.traversals.contentResource)), e2.rendering && (e2.rendering = this.traverseOneOrManyType(e2.rendering, this.traversals.contentResource)), e2.service && (e2.service = this.traverseOneOrMoreServices(e2.service)), e2.seeAlso && (e2.seeAlso = this.traverseOneOrManyType(e2.seeAlso, this.traversals.contentResource)), e2.within && (\"string\" == typeof e2.within || (e2.within = this.traverseOneOrManyType(e2.within, this.traversals.contentResource))), e2.startCanvas && (\"string\" == typeof e2.startCanvas ? e2.startCanvas = this.traverseType({ \"@id\": e2.startCanvas, \"@type\": \"sc:Canvas\" }, this.traversals.canvas) : e2.startCanvas && this.traverseType(e2.startCanvas, this.traversals.canvas)), e2.contentLayer && (\"string\" == typeof e2.contentLayer ? e2.contentLayer = this.traverseLayer({ \"@id\": e2.contentLayer, \"@type\": \"sc:Layer\" }) : e2.contentLayer = this.traverseLayer(e2.contentLayer)), e2;\n      }\n      traverseOneOrManyType(e2, t2) {\n        if (!Array.isArray(e2)) {\n          if (!this.options.convertPropsToArray)\n            return this.traverseType(e2, t2);\n          e2 = [e2];\n        }\n        return e2.map((e3) => this.traverseType(e3, t2));\n      }\n      traverseType(e2, t2) {\n        return t2.reduce((e3, t3) => {\n          const i2 = t3(e3);\n          return void 0 !== i2 || this.options.allowUndefinedReturn ? i2 : e3;\n        }, e2);\n      }\n    }\n    const S = \"Attribution\", j = \"http://example.org/provider\", R = \"Unknown\";\n    function I(e2, t2 = \"none\") {\n      if (!e2)\n        return {};\n      const i2 = Array.isArray(e2) ? e2 : [e2], r2 = {};\n      for (const n2 of i2) {\n        if (\"string\" == typeof n2) {\n          r2[t2] = r2[t2] ? r2[t2] : [], r2[t2].push(n2 || \"\");\n          continue;\n        }\n        if (!n2[\"@language\"]) {\n          r2[t2] = r2[t2] ? r2[t2] : [], r2[t2].push(n2[\"@value\"] || \"\");\n          continue;\n        }\n        const e3 = n2[\"@language\"];\n        r2[e3] = r2[e3] ? r2[e3] : [], r2[e3].push(n2[\"@value\"] || \"\");\n      }\n      return r2;\n    }\n    function T(e2) {\n      return Array.isArray(e2) ? T(e2.find((e3) => \"string\" == typeof e3)) : -1 !== x.indexOf(e2) ? \"level2\" : -1 !== C.indexOf(e2) ? \"level1\" : \"string\" == typeof e2 ? e2 : void 0;\n    }\n    function k(e2) {\n      for (const t2 of [\"sc\", \"oa\", \"dcterms\", \"dctypes\", \"iiif\"])\n        if (e2.startsWith(`${t2}:`))\n          return e2.slice(t2.length + 1);\n      return e2;\n    }\n    const O = [\"Collection\", \"Manifest\", \"Annotation\", \"AnnotationPage\", \"Range\", \"Service\"];\n    function M(e2) {\n      const t2 = e2[\"@id\"] || e2.id;\n      let i2 = e2[\"@type\"] || e2.type;\n      const r2 = e2.profile || void 0, n2 = e2[\"@context\"] || void 0;\n      if (r2) {\n        const e3 = function(e4) {\n          switch (e4) {\n            case \"http://iiif.io/api/image/2/level0.json\":\n            case \"http://iiif.io/api/image/2/level1.json\":\n            case \"http://iiif.io/api/image/2/level2.json\":\n              return \"ImageService2\";\n            case \"http://iiif.io/api/auth/1/kiosk\":\n            case \"http://iiif.io/api/auth/1/login\":\n            case \"http://iiif.io/api/auth/1/clickthrough\":\n            case \"http://iiif.io/api/auth/1/external\":\n            case \"http://iiif.io/api/auth/0/kiosk\":\n            case \"http://iiif.io/api/auth/0/login\":\n            case \"http://iiif.io/api/auth/0/clickthrough\":\n            case \"http://iiif.io/api/auth/0/external\":\n              return \"AuthCookieService1\";\n            case \"http://iiif.io/api/auth/1/token\":\n            case \"http://iiif.io/api/auth/0/token\":\n              return \"AuthTokenService1\";\n            case \"http://iiif.io/api/auth/1/logout\":\n            case \"http://iiif.io/api/auth/0/logout\":\n              return \"AuthLogoutService1\";\n            case \"http://iiif.io/api/search/1/search\":\n            case \"http://iiif.io/api/search/0/search\":\n              return \"SearchService1\";\n            case \"http://iiif.io/api/search/1/autocomplete\":\n            case \"http://iiif.io/api/search/0/autocomplete\":\n              return \"AutoCompleteService1\";\n          }\n        }(r2);\n        if (e3)\n          return e3;\n      }\n      if (n2) {\n        const e3 = function(e4) {\n          const t3 = Array.isArray(e4) ? e4 : [e4];\n          for (const i3 of t3)\n            switch (i3) {\n              case \"http://iiif.io/api/image/2/context.json\":\n              case \"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2\":\n                return \"ImageService2\";\n              case \"http://iiif.io/api/image/1/context.json\":\n              case \"http://library.stanford.edu/iiif/image-api/1.1/context.json\":\n                return \"ImageService1\";\n              case \"http://iiif.io/api/annex/openannotation/context.json\":\n                return \"ImageApiSelector\";\n            }\n        }(n2);\n        if (e3)\n          return e3;\n      }\n      if (i2) {\n        if (Array.isArray(i2)) {\n          if (-1 !== i2.indexOf(\"oa:CssStylesheet\"))\n            return \"CssStylesheet\";\n          if (-1 !== i2.indexOf(\"cnt:ContentAsText\"))\n            return \"TextualBody\";\n          i2 = i2[0];\n        }\n        for (const e3 of [\"sc\", \"oa\", \"dcterms\", \"dctypes\", \"iiif\"])\n          if (i2.startsWith(`${e3}:`)) {\n            i2 = i2.slice(e3.length + 1);\n            break;\n          }\n        switch (i2) {\n          case \"Layer\":\n            return \"AnnotationCollection\";\n          case \"AnnotationList\":\n            return \"AnnotationPage\";\n          case \"cnt:ContentAsText\":\n            return \"TextualBody\";\n        }\n      }\n      if (i2 && -1 !== O.indexOf(i2))\n        return i2;\n      if (e2.format) {\n        if (e2.format.startsWith(\"image/\"))\n          return \"Image\";\n        if (e2.format.startsWith(\"text/\"))\n          return \"Text\";\n        if (\"application/pdf\" === e2.format)\n          return \"Text\";\n        if (e2.format.startsWith(\"application/\"))\n          return \"Dataset\";\n      }\n      return t2 && (t2.endsWith(\".jpg\") || t2.endsWith(\".png\") || t2.endsWith(\".jpeg\")) ? \"Image\" : i2 || \"unknown\";\n    }\n    const q = /http(s)?:\\/\\/(creativecommons.org|rightsstatements.org)[^\"'\\\\<\\n]+/gm;\n    function P(e2) {\n      const t2 = e2.match(q);\n      return t2 ? t2[0] : e2;\n    }\n    const _ = [\"http://iiif.io/api/presentation/2/context.json\", \"http://iiif.io/api/image/2/context.json\", \"http://iiif.io/api/image/1/context.json\", \"http://library.stanford.edu/iiif/image-api/1.1/context.json\", \"http://iiif.io/api/search/1/context.json\", \"http://iiif.io/api/search/0/context.json\", \"http://iiif.io/api/auth/1/context.json\", \"http://iiif.io/api/auth/0/context.json\", \"http://iiif.io/api/annex/openannotation/context.json\"];\n    function D(e2) {\n      if (e2) {\n        const t2 = Array.isArray(e2) ? e2 : [e2], i2 = [];\n        for (const e3 of t2)\n          \"http://iiif.io/api/presentation/2/context.json\" === e3 && i2.push(\"http://iiif.io/api/presentation/3/context.json\"), -1 === _.indexOf(e3) && i2.push(e3);\n        if (t2.length)\n          return 1 === i2.length ? i2[0] : i2;\n      }\n    }\n    function U(e2) {\n      for (const t2 in e2)\n        void 0 !== e2[t2] && null !== e2[t2] || delete e2[t2];\n      return e2;\n    }\n    let $ = 0;\n    function W(e2, t2) {\n      const i2 = encodeURI(e2.id || e2[\"@id\"] || \"\").trim();\n      return i2 && t2 ? `${i2}/${t2}` : i2 || ($++, `http://example.org/${e2[\"@type\"]}${t2 ? `/${t2}` : \"\"}/${$}`);\n    }\n    function E(e2) {\n      const t2 = [...e2.behavior || []];\n      let i2;\n      return e2.viewingHint && t2.push(e2.viewingHint), Array.isArray(e2.motivation) ? i2 = e2.motivation.map(k) : e2.motivation && (i2 = k(e2.motivation)), { \"@context\": e2[\"@context\"] ? D(e2[\"@context\"]) : void 0, id: (e2[\"@id\"] || W(e2)).trim(), type: M(e2), behavior: t2.length ? t2 : void 0, height: e2.height ? e2.height : void 0, width: e2.width ? e2.width : void 0, motivation: i2, viewingDirection: e2.viewingDirection, profile: e2.profile, format: e2.format ? e2.format : void 0, duration: void 0, timeMode: void 0 };\n    }\n    function F(e2) {\n      const [t2, i2] = function(e3, t3 = \"Rights/License\", i3 = \"none\") {\n        let r3 = null;\n        const n3 = [], s2 = Array.isArray(e3) ? e3 : [e3];\n        for (const a2 of s2) {\n          const e4 = a2 ? P(a2) : void 0;\n          !e4 || -1 === e4.indexOf(\"creativecommons.org\") && -1 === e4.indexOf(\"rightsstatements.org\") ? e4 && n3.push({ label: { [i3]: [t3] }, value: { [i3]: [e4] } }) : r3 = e4.startsWith(\"https://\") ? `http://${e4.slice(8)}` : e4;\n        }\n        return [r3, n3];\n      }(e2.license), r2 = [...e2.metadata ? (n2 = e2.metadata, n2 ? n2.map((e3) => ({ label: I(e3.label), value: I(e3.value) })) : []) : [], ...i2];\n      var n2;\n      return { rights: t2, metadata: r2.length ? r2 : void 0, label: e2.label ? I(e2.label) : void 0, requiredStatement: e2.attribution ? { label: I(S), value: I(e2.attribution) } : void 0, navDate: e2.navDate, summary: e2.description ? I(e2.description) : void 0, thumbnail: e2.thumbnail };\n    }\n    function H(e2) {\n      if (!e2.within)\n        return;\n      const t2 = Array.isArray(e2.within) ? e2.within : [e2.within], i2 = [];\n      for (const r2 of t2)\n        if (\"string\" == typeof r2) {\n          if (r2 && \"sc:Manifest\" === e2[\"@type\"])\n            i2.push({ id: r2, type: \"Collection\" });\n        } else\n          r2[\"@id\"] && i2.push({ id: r2[\"@id\"], type: M(r2) });\n      return i2.length ? i2 : void 0;\n    }\n    function N(e2) {\n      const t2 = e2.related ? Array.isArray(e2.related) ? e2.related : [e2.related] : [], i2 = e2.contentLayer;\n      return { provider: e2.logo || t2.length ? [{ id: j, type: \"Agent\", homepage: t2.length ? [t2[0]] : void 0, logo: e2.logo ? Array.isArray(e2.logo) ? e2.logo : [e2.logo] : void 0, label: I(R) }] : void 0, partOf: H(e2), rendering: e2.rendering, seeAlso: e2.seeAlso, start: e2.startCanvas, service: e2.service ? (r2 = e2.service, Array.isArray(r2) ? r2 : [r2]) : void 0, supplementary: i2 ? [i2] : void 0 };\n      var r2;\n    }\n    function B(e2) {\n      const t2 = e2;\n      return U({ ...E(t2), ...F(t2), ...N(t2), ...(i2 = t2, { chars: i2.chars, format: i2.format ? i2.format : void 0, language: i2.language }) });\n      var i2;\n    }\n    const z = new L({ collection: [function(e2) {\n      return U({ ...E(e2), ...F(e2), ...N(e2), items: e2.members });\n    }], manifest: [function(e2) {\n      const t2 = [], i2 = [];\n      for (const n2 of e2.sequences || [])\n        n2.canvases.length && t2.push(...n2.canvases), n2.behavior && i2.push(...n2.behavior);\n      const r2 = E(e2);\n      return i2.length && (r2.behavior ? r2.behavior.push(...i2) : r2.behavior = i2), U({ ...r2, ...F(e2), ...N(e2), items: t2, structures: e2.structures });\n    }], canvas: [function(e2) {\n      return U({ ...E(e2), ...F(e2), ...N(e2), annotations: e2.otherContent && e2.otherContent.length ? e2.otherContent : void 0, items: e2.images && e2.images.length ? [{ id: W(e2, \"annotation-page\"), type: \"AnnotationPage\", items: e2.images }] : void 0 });\n    }], annotationList: [function(e2) {\n      return U({ ...E(e2), ...F(e2), ...N(e2), items: e2.resources && e2.resources.length ? e2.resources : void 0 });\n    }], sequence: [function(e2) {\n      return e2.canvases && 0 !== e2.canvases.length ? { canvases: e2.canvases, behavior: e2.viewingHint ? [e2.viewingHint] : [] } : { canvases: [], behavior: [] };\n    }], annotation: [function(e2) {\n      return U({ ...E(e2), ...F(e2), ...N(e2), target: function e3(t2) {\n        if (Array.isArray(t2)) {\n          if (t2.length > 1)\n            return { type: \"List\", items: t2.map(e3) };\n          t2 = t2[0];\n        }\n        if (\"string\" == typeof t2)\n          return encodeURI(t2).trim();\n        if (\"@type\" in t2) {\n          let e4;\n          if (\"string\" == typeof t2.full)\n            e4 = t2.full;\n          else if (\"dctypes:Image\" === t2.full[\"@type\"])\n            e4 = { id: t2.full[\"@id\"], type: \"Image\" };\n          else {\n            if (\"sc:Canvas\" !== t2.full[\"@type\"])\n              throw new Error(`Unsupported source type on annotation: ${t2.full[\"@type\"]}`);\n            e4 = { id: t2.full[\"@id\"], type: \"Canvas\" };\n          }\n          return { type: \"SpecificResource\", source: e4, selector: G(t2.selector) };\n        }\n        return encodeURI(t2[\"@id\"]).trim();\n      }(e2.on), body: Array.isArray(e2.resource) ? e2.resource.map(B) : B(e2.resource) });\n    }], contentResource: [B], choice: [function(e2) {\n      const t2 = [];\n      return e2.default && \"rdf:nil\" !== e2.default && t2.push(e2.default), e2.item && \"rdf:nil\" !== e2.item && t2.push(...e2.item), { ...E(e2), ...F(e2), items: t2 };\n    }], range: [function(e2) {\n      return U({ ...E(e2), ...F(e2), ...N(e2), items: e2.members });\n    }], service: [function(e2) {\n      const { \"@id\": t2, \"@type\": i2, \"@context\": r2, profile: n2, ...s2 } = e2, a2 = {};\n      return t2 && (a2[\"@id\"] = t2), a2[\"@type\"] = M(e2), \"unknown\" === a2[\"@type\"] && (r2 && r2.length && (a2[\"@context\"] = r2), a2[\"@type\"] = \"Service\"), n2 && (a2.profile = T(n2)), U({ ...a2, ...s2 });\n    }], layer: [function(e2) {\n      return U({ ...E(e2), ...F(e2), ...N(e2) });\n    }] });\n    function G(e2) {\n      if ((Array.isArray(e2[\"@type\"]) && e2[\"@type\"].includes(\"oa:SvgSelector\") || \"oa:SvgSelector\" == e2[\"@type\"]) && (\"chars\" in e2 || \"value\" in e2))\n        return { type: \"SvgSelector\", value: \"chars\" in e2 ? e2.chars : e2.value };\n      if (\"oa:FragmentSelector\" === e2[\"@type\"])\n        return { type: \"FragmentSelector\", value: e2.value };\n      if (\"oa:Choice\" === e2[\"@type\"])\n        return [G(e2.default), ...(Array.isArray(e2.item) ? e2.item : [e2.item]).map(G)];\n      if (\"iiif:ImageApiSelector\" == e2[\"@type\"])\n        return { type: \"ImageApiSelector\", region: \"region\" in e2 ? e2.region : void 0, rotation: \"rotation\" in e2 ? e2.rotation : void 0 };\n      throw new Error(`Unsupported selector type: ${e2[\"@type\"]}`);\n    }\n    const J = function(e2) {\n      return e2 && e2[\"@context\"] && (\"http://iiif.io/api/presentation/2/context.json\" === e2[\"@context\"] || -1 !== e2[\"@context\"].indexOf(\"http://iiif.io/api/presentation/2/context.json\") || \"http://www.shared-canvas.org/ns/context.json\" === e2[\"@context\"]) || \"http://iiif.io/api/image/2/context.json\" === e2[\"@context\"] ? z.traverseUnknown(e2) : e2;\n    };\n    e.upgrade = J, Object.defineProperties(e, { __esModule: { value: true }, [Symbol.toStringTag]: { value: \"Module\" } });\n  });\n})(index_umd, index_umd.exports);\nfunction fetchAndUpgrade(input, init) {\n  return fetch(input, init).then((resp) => resp.json()).then(index_umd.exports.upgrade);\n}\nexport { fetchAndUpgrade as fetch };\n//# sourceMappingURL=fetch.mjs.map\n","import * as Presentation3 from '@iiif/presentation-3';\n\nimport React, { ReactNode, createContext, useContext, useEffect, useMemo, useState } from 'react';\n\nimport { Orientation } from 'src/types/options';\nimport { fetch } from '@iiif/vault-helpers/fetch';\n\ninterface IIIFContentContext {\n  currentResourceId: string | undefined;\n  error: string | any | null;\n  isLoaded: boolean;\n  orientation: Orientation;\n  resource?: Presentation3.Manifest | Presentation3.Collection;\n}\n\nexport const ReactContext = createContext<IIIFContentContext>({\n  currentResourceId: undefined,\n  error: null,\n  isLoaded: false,\n  orientation: 'vertical',\n  resource: undefined,\n});\n\nexport function useThumbnailPanelContext() {\n  return useContext(ReactContext);\n}\n\nexport function IIIFContentProvider(props: {\n  resource: string | any;\n  children: ReactNode;\n  overrides?: Partial<Presentation3.Manifest | Presentation3.Collection>;\n  currentResourceId: string | undefined;\n  orientation: Orientation;\n  onLoad?: (resource?: Presentation3.Manifest | Presentation3.Collection) => void;\n  onResourceChanged?: (resourceId: string) => void;\n}) {\n  const { currentResourceId, orientation, onLoad, overrides } = props;\n  const [resource, setResource] = useState<Presentation3.Manifest | Presentation3.Collection>();\n  const mergedResource = useMemo(() => {\n    if (!overrides || !resource) {\n      return resource;\n    }\n\n    const values = Object.fromEntries(Object.entries(overrides).filter(([, value]) => typeof value !== 'undefined'));\n\n    return Object.assign({}, resource, values || {});\n  }, [resource, ...Object.values(overrides || {})]);\n  const [error, setError] = useState(false);\n\n  useEffect(() => {\n    if (!props.resource) {\n      return;\n    }\n\n    if (typeof props.resource === 'string') {\n      const controller = new AbortController();\n\n      fetch(props.resource, { signal: controller.signal })\n        .then((json) => {\n          setResource(json as any);\n          if (onLoad) {\n            onLoad(json);\n          }\n        })\n        .catch((e) => setError(e));\n\n      return () => {\n        controller.abort();\n      };\n    } else {\n      setResource(props.resource);\n      if (onLoad) {\n        onLoad(props.resource);\n      }\n    }\n  }, [props.resource]);\n\n  const value = useMemo(() => {\n    return { resource: mergedResource, error, isLoaded: !!resource, orientation, currentResourceId };\n  }, [mergedResource, error, orientation, currentResourceId]);\n\n  return <ReactContext.Provider value={value}>{props.children}</ReactContext.Provider>;\n}\n","import { Canvas, Collection, Manifest } from '@iiif/presentation-3';\nimport React, { useEffect, useState } from 'react';\n\nimport { createThumbnailHelper } from '@iiif/vault-helpers';\nimport { useThumbnailPanelContext } from '../context/IIIFResourceContext';\n\ninterface ThumbnailProps {\n  item: Canvas | Collection | Manifest;\n  onClick?: (resourceId?: string) => void;\n}\n\nexport const Thumbnail: React.FC<ThumbnailProps> = ({ item, onClick }) => {\n  const helper = createThumbnailHelper(); // no vault\n  const [thumb, setThumb] = useState<any>();\n  const { resource } = useThumbnailPanelContext();\n  const thumbnailSize = (resource as any)?.thumbnailSize || 200;\n\n  useEffect(() => {\n    async function getData() {\n      const response = await helper.getBestThumbnailAtSize(item as any, {\n        width: thumbnailSize,\n        height: thumbnailSize,\n      });\n      setThumb(response.best as any);\n    }\n\n    item && getData();\n  }, [item]);\n\n  return (\n    <button\n      data-testid=\"thumbnail-wrapper\"\n      onClick={() => {\n        if (onClick) {\n          onClick(resource?.id);\n        }\n      }}\n    >\n      <figure>\n        <div\n          style={{\n            backgroundColor: '#f0f0f0',\n            width: `${thumbnailSize}px`,\n            height: `${thumbnailSize}px`,\n            objectFit: 'contain',\n          }}\n        >\n          {thumb ? (\n            <img src={thumb.id} alt=\"\" style={{ maxWidth: '100%', maxHeight: '100%' }} data-testid=\"thumb-image\" />\n          ) : (\n            <></>\n          )}\n        </div>\n        <figcaption>{item.id}</figcaption>\n      </figure>\n    </button>\n  );\n};\n","const metaState = {};\nconst compatVault = {\n  get(nonRef) {\n    return nonRef;\n  },\n  setMetaValue([id, meta, key], value) {\n    const oldValue = compatVault.getResourceMeta(id, meta);\n    const oldValueItem = oldValue ? oldValue[key] : void 0;\n    const newValue = typeof value === \"function\" ? value(oldValueItem) : value;\n    metaState[id] = {\n      ...metaState[id] || {},\n      [meta]: {\n        ...(metaState[id] || {})[meta] || {},\n        [key]: newValue\n      }\n    };\n  },\n  getResourceMeta: (resource, metaKey) => {\n    const resourceMeta = metaState[resource];\n    if (!resourceMeta) {\n      return void 0;\n    }\n    if (!metaKey) {\n      return resourceMeta;\n    }\n    return resourceMeta[metaKey];\n  }\n};\nfunction findAllCanvasesInRange(vault, range) {\n  const found = [];\n  for (const inner of range.items) {\n    if (inner.type === \"Canvas\") {\n      if (inner.id.indexOf(\"#\") !== -1) {\n        found.push({ id: inner.id.split(\"#\")[0], type: \"Canvas\" });\n      } else {\n        found.push(inner);\n      }\n    }\n    if (inner.type === \"Range\") {\n      found.push(...findAllCanvasesInRange(vault, vault.get(inner)));\n    }\n    if (inner.type === \"SpecificResource\") {\n      const sourceId = typeof inner.source === \"string\" ? inner.source : inner.source.id;\n      found.push({ id: sourceId, type: \"Canvas\" });\n    }\n  }\n  return found;\n}\nfunction createSequenceHelper(vault = compatVault) {\n  return {\n    getVisibleCanvasesFromCanvasId: (manifestOrRange, canvasId, preventPaged = false) => getVisibleCanvasesFromCanvasId(vault, manifestOrRange, canvasId, preventPaged),\n    getManifestSequence: (manifestOrRange, options = {}) => getManifestSequence(vault, manifestOrRange, options)\n  };\n}\nfunction getVisibleCanvasesFromCanvasId(vault = compatVault, manifestOrRange, canvasId, preventPaged = false) {\n  const behavior = manifestOrRange.behavior || [];\n  const fullCanvas = canvasId ? vault.get(canvasId) : null;\n  if (!fullCanvas) {\n    return [];\n  }\n  const canvasBehavior = fullCanvas.behavior || [];\n  const isPaged = preventPaged ? false : behavior.includes(\"paged\");\n  const isContinuous = isPaged ? false : behavior.includes(\"continuous\");\n  const isIndividuals = isPaged || isContinuous ? false : behavior.includes(\"individuals\");\n  const isCanvasFacingPages = canvasBehavior.includes(\"facing-pages\");\n  const isCanvasNonPaged = canvasBehavior.includes(\"non-paged\");\n  if (isCanvasFacingPages || isCanvasNonPaged || isIndividuals || preventPaged) {\n    return [{ id: fullCanvas.id, type: \"Canvas\" }];\n  }\n  const [manifestItems, ordering] = getManifestSequence(vault, manifestOrRange);\n  if (isContinuous) {\n    return manifestItems;\n  }\n  const canvasIndex = manifestItems.findIndex((r) => r.id === canvasId);\n  if (canvasIndex === -1) {\n    return [];\n  }\n  for (const indexes of ordering) {\n    if (indexes.includes(canvasIndex)) {\n      return indexes.map((index) => manifestItems[index]);\n    }\n  }\n  return [{ id: fullCanvas.id, type: \"Canvas\" }];\n}\nfunction getManifestSequence(vault = compatVault, manifestOrRange, { disablePaging, skipNonPaged } = {}) {\n  const behavior = manifestOrRange.behavior || [];\n  const isPaged = behavior.includes(\"paged\");\n  const isContinuous = isPaged ? false : behavior.includes(\"continuous\");\n  const isIndividuals = isPaged || isContinuous ? false : behavior.includes(\"individuals\");\n  const manifestItems = manifestOrRange.type === \"Manifest\" ? manifestOrRange.items : findAllCanvasesInRange(vault, manifestOrRange);\n  if (isContinuous) {\n    return [manifestItems, [manifestItems.map((_, index) => index)]];\n  }\n  if (isIndividuals || !isPaged || disablePaging) {\n    return [manifestItems, manifestItems.map((_, index) => [index])];\n  }\n  const ordering = [];\n  let currentOrdering = [];\n  const flush = () => {\n    if (currentOrdering.length) {\n      ordering.push([...currentOrdering]);\n      currentOrdering = [];\n    }\n  };\n  let offset = 0;\n  let flushNextPaged = false;\n  for (let i = 0; i < manifestItems.length; i++) {\n    const canvas = vault.get(manifestItems[i]);\n    const canvasBehavior = canvas.behavior || [];\n    if (canvasBehavior.includes(\"non-paged\")) {\n      if (i === offset) {\n        offset++;\n      }\n      if (!skipNonPaged) {\n        flush();\n        ordering.push([i]);\n        flush();\n      }\n      continue;\n    }\n    if (i === offset || canvasBehavior.includes(\"facing-pages\")) {\n      if (currentOrdering.length) {\n        flushNextPaged = true;\n      }\n      flush();\n      ordering.push([i]);\n      flush();\n      continue;\n    }\n    currentOrdering.push(i);\n    if (flushNextPaged) {\n      flush();\n      flushNextPaged = false;\n      continue;\n    }\n    if (currentOrdering.length > 1) {\n      flush();\n    }\n  }\n  if (currentOrdering.length) {\n    flush();\n  }\n  return [manifestItems, ordering];\n}\nexport { createSequenceHelper, getManifestSequence, getVisibleCanvasesFromCanvasId };\n//# sourceMappingURL=sequences.mjs.map\n","import '../style.css';\n\nimport * as Presentation3 from '@iiif/presentation-3';\n\nimport { IIIFContentProvider, useThumbnailPanelContext } from '../context/IIIFResourceContext';\nimport React, { useMemo } from 'react';\n\nimport { Orientation } from 'src/types/options';\nimport { Thumbnail } from './Thumbnail';\nimport { createSequenceHelper } from '@iiif/vault-helpers/sequences';\nimport { getValue } from '@iiif/vault-helpers';\n\ntype OnResourceChanged = (resourceId?: string) => void;\ninterface ItemsProps {\n  onResourceChanged?: OnResourceChanged;\n}\n\nconst Items: React.FC<ItemsProps> = ({ onResourceChanged }) => {\n  const { resource, isLoaded, currentResourceId, orientation } = useThumbnailPanelContext();\n  const sequence = createSequenceHelper();\n\n  const [items, seq] = useMemo(() => {\n    if (!resource) {\n      return [];\n    }\n    //ignore type checking on resource (expecting ManifestNormalized)\n    //@ts-ignore\n    const [items, seq] = sequence.getManifestSequence(resource, {\n      disablePaging: false,\n    });\n\n    // if (resource.viewingDirection === 'bottom-to-top') {\n    //   return [items, seq.reverse()]\n    // }\n\n    return [items, seq];\n  }, [resource]);\n\n  if (!isLoaded || !resource || !seq || !items) {\n    return <></>;\n  }\n\n  const dir = resource.viewingDirection === 'left-to-right' ? 'ltr' : 'rtl';\n\n  const onKeyDown = (e: any) => {\n    if (e.keyCode === 40) {\n      const next = 1 + Number(e.currentTarget.getAttribute('data-index'));\n      `div[data-index=\"${next}\"]`;\n      const nextElement = (e.currentTarget as HTMLDivElement).parentElement?.parentElement?.querySelector(\n        `div[data-index=\"${next}\"]`\n      ) as HTMLElement;\n      nextElement.focus();\n    }\n  };\n\n  const isCurrentGroup = (groupIdx: number) => {\n    const foundIdx = seq.findIndex((group) => {\n      const resourceIdx = items.findIndex((resource) => {\n        return resource.id === currentResourceId;\n      });\n      return group.includes(resourceIdx);\n    });\n\n    return foundIdx === groupIdx;\n  };\n\n  return (\n    <div dir={dir} thumbnail-panel=\"\" data-orientation={orientation}>\n      <h3>{getValue(resource.label)}</h3>\n      <span>{orientation}</span>\n\n      {seq.map((group, groupIdx) => {\n        // console.log('group', group);\n        return (\n          <div thumbnail-group=\"\" key={groupIdx} data-selected={isCurrentGroup(groupIdx)}>\n            {group.map((idx, itemIdx) => (\n              <div\n                thumbnail-item=\"\"\n                tabIndex={idx === 0 ? 0 : -1}\n                key={itemIdx}\n                data-index={idx}\n                onKeyDown={onKeyDown}\n                data-selected={currentResourceId === items[idx]?.id}\n              >\n                <Thumbnail\n                  key={idx}\n                  item={items[idx]}\n                  onClick={() => {\n                    // todo: set state\n                    if (onResourceChanged) {\n                      // console.log(idx);\n                      onResourceChanged(items[idx]?.id);\n                    }\n                  }}\n                />\n              </div>\n            ))}\n          </div>\n        );\n      })}\n\n      {/* <p>{resource.behavior}</p>\n      <p>{resource.viewingDirection || 'left-to-right'}</p>\n      {resource?.items.map((item, index) => (\n        <>\n          <Thumbnail key={index} item={item} />\n        </>\n      ))} */}\n    </div>\n  );\n};\n\ninterface ThumbnailPanelProps {\n  currentResourceId: string | undefined;\n  iiifContent: string;\n  onLoad?: (resource: any) => void;\n  onResourceChanged?: OnResourceChanged;\n  orientation: Orientation;\n  overrides?: Partial<Presentation3.Collection | Presentation3.Manifest>;\n}\n\nexport const ThumbnailPanel: React.FC<ThumbnailPanelProps> = ({\n  iiifContent,\n  orientation,\n  currentResourceId,\n  overrides,\n  onLoad,\n  onResourceChanged,\n}) => {\n  return (\n    <IIIFContentProvider\n      resource={iiifContent}\n      overrides={overrides}\n      orientation={orientation}\n      currentResourceId={currentResourceId}\n      onLoad={onLoad}\n    >\n      <Items onResourceChanged={onResourceChanged} />\n    </IIIFContentProvider>\n  );\n};\n"],"names":["k","p","q","b","h","ReactDebugCurrentFrame","x","self","jsx","jsxs","require$$0","require$$1","metaState","compatVault","v","y","A","C","w","L","j","R","I","T","O","M","P","_","D","U","$","W","E","F","H","N","B","z","G","J","value","fetch","items","seq","resource","_a"],"mappings":"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"}